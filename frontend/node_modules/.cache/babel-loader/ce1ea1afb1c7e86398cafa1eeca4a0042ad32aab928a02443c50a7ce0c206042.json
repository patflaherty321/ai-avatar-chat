{"ast":null,"code":"import React,{useState,useEffect,useCallback,useRef}from'react';import Avatar from'./Avatar';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[messages,setMessages]=useState([{role:'assistant',content:'Hello! I\\'m your AI companion. How can I help you today?'}]);const[inputMessage,setInputMessage]=useState('');const[isLoading,setIsLoading]=useState(false);const[audioUrl,setAudioUrl]=useState('');const[visemes,setVisemes]=useState([]);const[isPlaying,setIsPlaying]=useState(false);const[isMicActive,setIsMicActive]=useState(false);const[isListening,setIsListening]=useState(false);const[recognition,setRecognition]=useState(null);const[audioEnabled,setAudioEnabled]=useState(false);const[horizontalPadding,setHorizontalPadding]=useState(60);const[maxWidth,setMaxWidth]=useState('100%');const[windowWidth,setWindowWidth]=useState(typeof window!=='undefined'?window.innerWidth:1200);// Ref for auto-scrolling chat messages\nconst messagesEndRef=useRef(null);// Debug render state\nconsole.log('üîÑ App render state:',{inputMessage:inputMessage.length,isLoading,isListening,audioEnabled,recognition:!!recognition,messagesCount:messages.length});// Auto-scroll to bottom when messages change\nuseEffect(()=>{if(messagesEndRef.current){messagesEndRef.current.scrollIntoView({behavior:'smooth'});}},[messages,isLoading]);// Calculate responsive layout based on screen width\nconst calculateLayout=()=>{const screenWidth=typeof window!=='undefined'?window.innerWidth:1200;setWindowWidth(screenWidth);const fixedPadding=60;const maxContentWidth=1080;// Fixed content width when centered\nif(screenWidth<1080){// Mobile layout: stack vertically with full width\nsetHorizontalPadding(fixedPadding);setMaxWidth('100%');console.log(`üì± MOBILE MODE: Width=${screenWidth}px, Padding=${fixedPadding}px, MaxWidth=100%, Layout=Vertical`);}else{// Desktop layout: center the UI with fixed max width\nsetHorizontalPadding(fixedPadding);setMaxWidth(`${maxContentWidth}px`);console.log(`üñ•Ô∏è DESKTOP MODE: Width=${screenWidth}px, Padding=${fixedPadding}px, MaxWidth=${maxContentWidth}px, Layout=Horizontal`);}};// Calculate avatar scale to completely fill the Avatar-MAIN panel\nconst calculateAvatarScale=()=>{// Use current window width directly if windowWidth state isn't ready\nconst currentWidth=windowWidth||(typeof window!=='undefined'?window.innerWidth:1200);let scale;if(currentWidth>=1080){// Desktop: scale optimized for 4000x4000px high-res Rive file\nscale=1.8;// Reduced from 3.0 for high-resolution Rive file\n}else{// Mobile: scale optimized for 4000x4000px high-res Rive file\nscale=2.2;// Reduced from 4.5 for high-resolution Rive file\n}console.log(`üîß Avatar Scale Calculation (4000px Rive): windowWidth=${windowWidth}, currentWidth=${currentWidth}, scale=${scale}`);return scale;};// Update layout on mount and window resize\nuseEffect(()=>{// Ensure layout is calculated immediately on mount\ncalculateLayout();const handleResize=()=>{calculateLayout();};window.addEventListener('resize',handleResize);return()=>window.removeEventListener('resize',handleResize);},[]);const enableAudio=useCallback(async()=>{try{console.log('üîä Attempting to enable audio...');// Add timeout to prevent hanging\nconst audioPromise=new Promise(async(resolve,reject)=>{try{// Create a dummy audio context to enable audio permissions\nconst audioContext=new(window.AudioContext||window.webkitAudioContext)();await audioContext.resume();// Create and play a silent audio to unlock autoplay\nconst audio=new Audio();audio.src='data:audio/wav;base64,UklGRnoAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=';audio.volume=0.01;// Very low volume\n// Add event listeners to handle play result\naudio.oncanplaythrough=()=>{audio.play().then(()=>{resolve(true);}).catch(error=>{console.warn('üîá Silent audio play failed:',error);resolve(false);// Don't reject, just continue\n});};audio.onerror=()=>{console.warn('üîá Silent audio load failed');resolve(false);// Don't reject, just continue\n};// Fallback timeout\nsetTimeout(()=>{resolve(false);},1000);}catch(error){reject(error);}});// Timeout the entire operation\nconst timeoutPromise=new Promise(resolve=>{setTimeout(()=>{console.warn('‚è∞ Audio enablement timed out');resolve(false);},2000);});await Promise.race([audioPromise,timeoutPromise]);setAudioEnabled(true);// Always enable audio - the test might fail but actual playback could work\nconsole.log('‚úÖ Audio enabled (test may have failed but continuing anyway)');}catch(error){console.warn('‚ùå Could not enable audio:',error);setAudioEnabled(true);// Set to true anyway to allow the app to continue\n}},[]);const sendMessageToAI=useCallback(async messageText=>{console.log('üì§ sendMessageToAI called with:',messageText);if(!messageText.trim()||isLoading){console.log('‚ùå Message rejected - empty or loading');return;}setIsLoading(true);try{var _data$visemes;console.log('üöÄ Sending message to API:',messageText);const backendUrl=process.env.REACT_APP_BACKEND_URL||'http://localhost:3006';const response=await fetch(`${backendUrl}/api/chat`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:messageText})});console.log('üì° Response status:',response.status,response.statusText);if(!response.ok){const errorText=await response.text();console.error('‚ùå API Error Response:',errorText);throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);}const data=await response.json();console.log('‚úÖ API Response data:',data);console.log('üîç FORCE DEBUG - Audio/Viseme check:',{audioEnabled,hasAudioUrl:!!data.audioUrl,hasVisemeData:!!data.visemes,audioUrl:data.audioUrl,visemeDataLength:(_data$visemes=data.visemes)===null||_data$visemes===void 0?void 0:_data$visemes.length,visemeDataType:typeof data.visemes,visemeDataValue:data.visemes});// Add AI response to chat\nconst aiMessage={role:'assistant',content:data.response||data.text||data.message};setMessages(prev=>[...prev,aiMessage]);// Check if response includes audio and visemes (new format from our backend)\n// Always process audio if available, since user has already enabled it by sending a message\nif(data.audioUrl&&data.visemes){try{var _data$visemes2,_convertedVisemes;console.log('üéµ Processing response with audio and visemes...');console.log('üéµ Audio URL:',data.audioUrl);console.log('üéµ Viseme data count:',((_data$visemes2=data.visemes)===null||_data$visemes2===void 0?void 0:_data$visemes2.length)||0);// Create full audio URL from relative path\nconst backendUrl=process.env.REACT_APP_BACKEND_URL||'http://localhost:3006';const fullAudioUrl=`${backendUrl}${data.audioUrl}`;// Convert viseme format to the format expected by Avatar component\nconst convertedVisemes=data.visemes.map(viseme=>({timeMs:viseme.timeMs,visemeId:viseme.visemeId}));console.log('üéµ Setting audio and visemes:',fullAudioUrl,convertedVisemes.length,'visemes');setAudioUrl(fullAudioUrl);setVisemes(convertedVisemes);setIsPlaying(true);// Reset playing state after audio duration (estimated from last viseme)\nconst lastVisemeTime=((_convertedVisemes=convertedVisemes[convertedVisemes.length-1])===null||_convertedVisemes===void 0?void 0:_convertedVisemes.timeMs)||3000;setTimeout(()=>{setIsPlaying(false);},lastVisemeTime+1000);}catch(audioError){console.error('‚ùå Error processing audio/visemes:',audioError);}}else{var _data$visemes3;console.log('üí¨ No audio/visemes in response - text-only chat mode');console.log('üîç Detailed debugging:',{audioEnabled:audioEnabled,audioEnabledType:typeof audioEnabled,hasAudioUrl:!!data.audioUrl,hasVisemeData:!!data.visemes,audioUrlType:typeof data.audioUrl,visemeDataType:typeof data.visemes,audioUrl:data.audioUrl||'none',visemeDataLength:((_data$visemes3=data.visemes)===null||_data$visemes3===void 0?void 0:_data$visemes3.length)||0,responseKeys:Object.keys(data),conditionResults:{audioEnabled_check:!!audioEnabled,audioUrl_check:!!data.audioUrl,visemeData_check:!!data.visemes,overallCondition:!!(audioEnabled&&data.audioUrl&&data.visemes)}});}}catch(error){console.error('‚ùå Error sending message - Full error object:',error);console.error('‚ùå Error name:',error.name);console.error('‚ùå Error message:',error.message);console.error('‚ùå Error stack:',error.stack);const errorMessage={role:'assistant',content:`Sorry, I encountered an error: ${error.message}. Please try again.`};setMessages(prev=>[...prev,errorMessage]);}finally{setIsLoading(false);}},[isLoading,audioEnabled]);// Initialize speech recognition\nuseEffect(()=>{console.log('üé§ Initializing speech recognition...');if('webkitSpeechRecognition'in window||'SpeechRecognition'in window){const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;const recognitionInstance=new SpeechRecognition();recognitionInstance.continuous=false;recognitionInstance.interimResults=false;recognitionInstance.lang='en-US';recognitionInstance.onstart=()=>{console.log('üé§ Speech recognition started');setIsListening(true);};recognitionInstance.onresult=event=>{const transcript=event.results[0][0].transcript;console.log('üó£Ô∏è Speech recognition result:',transcript);// Instead of setting input, directly send the message\nif(transcript.trim()){// Add user message to chat immediately\nconst userMessage={role:'user',content:transcript};setMessages(prev=>[...prev,userMessage]);// Send to AI backend\nsendMessageToAI(transcript);}setIsListening(false);setIsMicActive(false);};recognitionInstance.onerror=event=>{console.error('‚ùå Speech recognition error:',event.error);setIsListening(false);setIsMicActive(false);};recognitionInstance.onend=()=>{console.log('üõë Speech recognition ended');setIsListening(false);setIsMicActive(false);};setRecognition(recognitionInstance);console.log('‚úÖ Speech recognition initialized');}else{console.warn('‚ö†Ô∏è Speech recognition not supported in this browser');}},[sendMessageToAI]);const sendMessage=useCallback(async()=>{console.log('üìù sendMessage called with inputMessage:',inputMessage);if(!inputMessage.trim()||isLoading){console.log('‚ùå sendMessage rejected - empty or loading');return;}// Enable audio on user interaction (immediately, don't wait)\nif(!audioEnabled){console.log('üîä First interaction - enabling audio immediately...');setAudioEnabled(true);// Set immediately for faster response\nenableAudio().catch(error=>{console.warn('üîá Audio enabling failed but continuing:',error);});}// Add user message to chat\nconst userMessage={role:'user',content:inputMessage};setMessages(prev=>[...prev,userMessage]);// Send to AI and clear input\nconst messageToSend=inputMessage;setInputMessage('');// Don't await audio enabling, just continue\nconsole.log('üöÄ Proceeding to send message to AI...');await sendMessageToAI(messageToSend);},[inputMessage,isLoading,audioEnabled,enableAudio,sendMessageToAI]);const handleKeyPress=useCallback(e=>{console.log('‚å®Ô∏è Key pressed:',e.key);if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendMessage();}},[sendMessage]);const toggleMicrophone=useCallback(async()=>{console.log('üé§ toggleMicrophone called, recognition available:',!!recognition);if(!recognition){alert('Speech recognition is not supported in this browser. Please use Chrome, Safari, or Edge.');return;}// Enable audio on user interaction (immediately, don't wait)\nif(!audioEnabled){console.log('üîä First microphone interaction - enabling audio immediately...');setAudioEnabled(true);// Set immediately for faster response\nenableAudio().catch(error=>{console.warn('üîá Audio enabling failed but continuing:',error);});}if(isListening){// Stop listening\nconsole.log('üõë Stopping speech recognition');recognition.stop();setIsListening(false);setIsMicActive(false);}else{// Start listening\ntry{console.log('üé§ Starting speech recognition');recognition.start();setIsMicActive(true);}catch(error){console.error('‚ùå Error starting speech recognition:',error);alert('Error starting microphone. Please check your microphone permissions.');setIsMicActive(false);}}},[recognition,audioEnabled,enableAudio,isListening]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',height:'100vh',background:'#7C7C7C',flexDirection:'column',justifyContent:'flex-start',alignItems:'center',display:'flex',boxSizing:'border-box'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',position:'relative',flex:1,// Allow this section to grow and fill available space\ndisplay:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'row',alignItems:'center',justifyContent:'center',position:'relative',width:'100%',height:'100%'},children:/*#__PURE__*/_jsxs(\"div\",{style:{boxSizing:'border-box',display:'flex',flexDirection:windowWidth<1080?'column':'row',// Stack vertically on mobile\ngap:20,alignItems:windowWidth<1080?'stretch':'center',// Stretch full width on mobile\njustifyContent:'center',paddingLeft:horizontalPadding,paddingRight:horizontalPadding,paddingTop:20,paddingBottom:20,position:'relative',width:'100%',maxWidth:maxWidth,margin:'0 auto'},children:[/*#__PURE__*/_jsx(\"div\",{style:{flex:windowWidth<1080?'0 0 auto':'0 0 450px',height:windowWidth<1080?350:460,display:'flex',flexDirection:'column',alignItems:'flex-start',justifyContent:'center',padding:0,position:'relative',minHeight:windowWidth<1080?'300px':'350px',minWidth:windowWidth<1080?'100%':'330px',width:windowWidth<1080?'100%':'auto'},children:/*#__PURE__*/_jsx(\"div\",{style:{alignSelf:'stretch',height:windowWidth<1080?350:460,borderRadius:32,overflow:'hidden',position:'relative',width:'100%',flexGrow:1,flexShrink:0,flexBasis:0,minHeight:windowWidth<1080?'300px':'380px',minWidth:windowWidth<1080?'100%':'350px',maxWidth:windowWidth<1080?'100%':'450px',backgroundSize:'cover',backgroundPosition:'center',backgroundRepeat:'no-repeat'},children:/*#__PURE__*/_jsx(Avatar,{// Force re-render when scale changes\nisActive:true,isTalking:isPlaying,isThinking:isLoading,visemes:visemes,audioUrl:audioUrl,audioEnabled:audioEnabled,scale:calculateAvatarScale()},`avatar-${calculateAvatarScale()}`)})}),/*#__PURE__*/_jsx(\"div\",{style:{flex:windowWidth<1080?'0 0 auto':'1 1 0',height:windowWidth<1080?350:460,background:'#D9D9D9',borderRadius:32,minHeight:windowWidth<1080?'350px':'460px',minWidth:windowWidth<1080?'100%':'1px',width:windowWidth<1080?'100%':'auto',padding:windowWidth<1080?'0px':'0px 20px',display:'flex',flexDirection:'column',overflow:'hidden'},children:/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,overflowY:'auto',display:'flex',flexDirection:'column',gap:'12px',marginTop:'20px',marginBottom:'20px',paddingLeft:windowWidth<1080?'20px':'0px',paddingRight:windowWidth<1080?'20px':'0px'},children:[messages.map((message,index)=>/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:message.role==='user'?'flex-end':'flex-start',alignItems:'flex-start'},children:/*#__PURE__*/_jsx(\"div\",{style:{maxWidth:'80%',padding:'12px 16px',borderRadius:message.role==='user'?'16px 16px 4px 16px':'16px 16px 16px 4px',backgroundColor:message.role==='user'?'#007AFF':'white',color:message.role==='user'?'white':'#333',fontSize:'14px',lineHeight:'1.4',boxShadow:'0 1px 3px rgba(0,0,0,0.1)',textAlign:message.role==='user'?'right':'left'},children:message.content})},index)),isLoading&&/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'flex-start',alignItems:'flex-start'},children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px 16px',borderRadius:'16px 16px 16px 4px',backgroundColor:'white',color:'#666',fontSize:'14px',display:'flex',alignItems:'center',gap:'6px',boxShadow:'0 1px 3px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'4px',height:'4px',borderRadius:'50%',backgroundColor:'#666',animation:'pulse 1.5s infinite'}}),/*#__PURE__*/_jsx(\"div\",{style:{width:'4px',height:'4px',borderRadius:'50%',backgroundColor:'#666',animation:'pulse 1.5s infinite 0.2s'}}),/*#__PURE__*/_jsx(\"div\",{style:{width:'4px',height:'4px',borderRadius:'50%',backgroundColor:'#666',animation:'pulse 1.5s infinite 0.4s'}}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'6px'},children:\"Thinking...\"})]})}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef,style:{height:'1px'}})]})})]})})}),/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',position:'relative',flexShrink:0,marginTop:'auto'// Push to bottom\n},children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'row',alignItems:'center',position:'relative',width:'100%',height:'100%'},children:/*#__PURE__*/_jsxs(\"div\",{style:{boxSizing:'border-box',display:'flex',flexDirection:'row',gap:11,alignItems:'center',justifyContent:'flex-start',paddingLeft:horizontalPadding,paddingRight:horizontalPadding,paddingTop:0,paddingBottom:20,position:'relative',width:'100%',maxWidth:maxWidth,margin:'0 auto'},children:[/*#__PURE__*/_jsx(\"div\",{style:{position:'relative',flexShrink:0,width:48,height:48},children:/*#__PURE__*/_jsx(\"button\",{style:{position:'absolute',left:0,top:0,width:48,height:48,background:'transparent',borderRadius:24,border:'none',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsxs(\"svg\",{width:\"25\",height:\"25\",viewBox:\"0 0 25 25\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M24.6266 22.823C25.1243 23.3209 25.1243 24.1287 24.6266 24.6266C24.1287 25.1245 23.321 25.1243 22.823 24.6266L24.6266 22.823ZM11.1575 0.0138357C16.7639 0.298223 21.222 4.93396 21.222 10.611L21.2082 11.1575C21.0936 13.4163 20.2716 15.4878 18.9609 17.1573L19.5262 17.7236L24.6266 22.823L23.7243 23.7243L22.823 24.6266L17.7236 19.5262L17.1573 18.9609C15.354 20.3766 13.0815 21.222 10.611 21.222L10.0655 21.2082C4.63969 20.9334 0.289055 16.5832 0.0138357 11.1575L0 10.611C4.90281e-05 4.75073 4.75073 4.64216e-05 10.611 0L11.1575 0.0138357ZM10.611 1.60297C5.63604 1.60301 1.60302 5.63603 1.60297 10.611C1.60297 15.586 5.63601 19.619 10.611 19.619C15.586 19.619 19.619 15.5861 19.619 10.611C19.619 5.636 15.586 1.60297 10.611 1.60297Z\",fill:\"url(#paint0_linear_12_78)\"}),/*#__PURE__*/_jsx(\"defs\",{children:/*#__PURE__*/_jsxs(\"linearGradient\",{id:\"paint0_linear_12_78\",x1:\"4.59026\",y1:\"3.98128\",x2:\"18.4429\",y2:\"19.5244\",gradientUnits:\"userSpaceOnUse\",children:[/*#__PURE__*/_jsx(\"stop\",{stopColor:\"white\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"1\",stopColor:\"#E8E8E8\"})]})})]})})}),/*#__PURE__*/_jsxs(\"div\",{style:{flexGrow:1,flexShrink:0,flexBasis:0,height:56,background:'#FFFFFF',borderRadius:28,minHeight:'1px',minWidth:'1px',position:'relative',display:'flex',alignItems:'center',boxShadow:'0 2px 4px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:inputMessage,onChange:e=>{console.log('üìù Input changed:',e.target.value);setInputMessage(e.target.value);},onKeyPress:handleKeyPress,onFocus:()=>console.log('üéØ Input focused'),onBlur:()=>console.log('üëã Input blurred'),onClick:()=>console.log('üñ±Ô∏è Input clicked'),placeholder:isListening?\"Listening...\":\"Ask me anything...\",disabled:isLoading||isListening,style:{width:'100%',height:'100%',padding:'0px 60px 0px 20px',// No top/bottom padding needed for input\nborder:'none',borderRadius:32,fontSize:'16px',lineHeight:'24px',outline:'none',fontFamily:'inherit',backgroundColor:'transparent',color:'#333'}}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('üì§ Send button clicked');sendMessage();},disabled:!inputMessage.trim()||isLoading||isListening,style:{position:'absolute',right:'12px',top:'50%',transform:'translateY(-50%)',width:'32px',height:'32px',borderRadius:'50%',border:'none',background:!inputMessage.trim()||isLoading||isListening?'#999':'#007AFF',cursor:!inputMessage.trim()||isLoading||isListening?'not-allowed':'pointer',display:'flex',alignItems:'center',justifyContent:'center',transition:'all 0.2s ease',boxShadow:'0 2px 4px rgba(0,0,0,0.1)'},onMouseEnter:e=>{if(inputMessage.trim()&&!isLoading&&!isListening){e.target.style.transform='translateY(-50%) scale(1.1)';}},onMouseLeave:e=>{if(inputMessage.trim()&&!isLoading&&!isListening){e.target.style.transform='translateY(-50%)';}},children:isLoading?/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",stroke:\"white\",strokeWidth:\"2\",opacity:\"0.3\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 2C13.3132 2 14.6136 2.25866 15.8268 2.7612C17.0401 3.26375 18.1425 4.00035 19.0711 4.92893C19.9997 5.85752 20.7362 6.95991 21.2388 8.17317C21.7413 9.38642 22 10.6868 22 12\",stroke:\"white\",strokeWidth:\"2\",strokeLinecap:\"round\",children:/*#__PURE__*/_jsx(\"animateTransform\",{attributeName:\"transform\",attributeType:\"XML\",type:\"rotate\",from:\"0 12 12\",to:\"360 12 12\",dur:\"1s\",repeatCount:\"indefinite\"})})]}):/*#__PURE__*/_jsx(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M5 12H19M19 12L13 6M19 12L13 18\",stroke:\"white\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})})})]}),/*#__PURE__*/_jsx(\"div\",{style:{boxSizing:'border-box',display:'flex',flexDirection:'row',gap:11,alignItems:'center',justifyContent:'flex-end',padding:0,position:'relative',flexShrink:0},children:/*#__PURE__*/_jsx(\"div\",{style:{position:'relative',flexShrink:0,width:48,height:48},children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{console.log('üé§ Microphone button clicked');toggleMicrophone();},style:{position:'absolute',background:isListening?'#FF3B30':'#FFFFFF',left:0,top:0,borderRadius:24,width:48,height:48,border:'none',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',boxShadow:isListening?'0 4px 12px rgba(255, 59, 48, 0.3)':'0 2px 4px rgba(0,0,0,0.1)',transition:'all 0.2s ease',transform:isListening?'scale(1.1)':'scale(1)',overflow:'hidden'// Ensure the pulse animation is masked by the circular button\n},children:[(isMicActive||isListening)&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'50%',left:'50%',width:'20px',height:'20px',background:isListening?'rgba(255, 255, 255, 0.3)':'rgba(0, 122, 255, 0.3)',borderRadius:'50%',transform:'translate(-50%, -50%)',animation:'micPulse 2s infinite ease-in-out',zIndex:1}}),/*#__PURE__*/_jsxs(\"svg\",{width:\"23\",height:\"27\",viewBox:\"0 0 23 27\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",style:{position:'relative',zIndex:2},children:[/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",clipRule:\"evenodd\",d:\"M17.7428 6.24286C17.7428 2.79501 14.9478 0 11.4999 0C8.05215 0 5.25714 2.79503 5.25714 6.24286V15.4428C5.25714 18.8907 8.05215 21.6857 11.4999 21.6857C14.9478 21.6857 17.7428 18.8907 17.7428 15.4428V6.24286ZM11.4999 1.97143C13.8591 1.97143 15.7714 3.88381 15.7714 6.24286V15.4428C15.7714 17.8018 13.8591 19.7143 11.4999 19.7143C9.14093 19.7143 7.22856 17.8018 7.22856 15.4428V6.24286C7.22856 3.88381 9.14093 1.97143 11.4999 1.97143Z\",fill:isListening?\"#FFFFFF\":\"#33302E\"}),/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",clipRule:\"evenodd\",d:\"M22.0142 9.19999C21.4698 9.19999 21.0285 9.64131 21.0285 10.1857V15.4428C21.0285 20.7053 16.7624 24.9714 11.4999 24.9714C6.23751 24.9714 1.97143 20.7053 1.97143 15.4428V10.1857C1.97143 9.64131 1.5301 9.19999 0.985708 9.19999C0.441311 9.19999 0 9.64131 0 10.1857V15.4428C0 21.7941 5.14872 26.9429 11.4999 26.9429C17.8512 26.9429 23 21.7941 23 15.4428V10.1857C23 9.64131 22.5587 9.19999 22.0142 9.19999Z\",fill:isListening?\"#FFFFFF\":\"#33302E\"})]})]})})})]})})})]}),/*#__PURE__*/_jsx(\"style\",{children:`\n        .App {\n          width: 100vw;\n          height: 100vh;\n          margin: 0;\n          padding: 0;\n        }\n        \n        body {\n          margin: 0;\n          padding: 0;\n          width: 100%;\n          height: 100%;\n        }\n        \n        #root {\n          width: 100%;\n          height: 100%;\n        }\n        \n        @keyframes pulse {\n          0%, 100% { opacity: 0.5; transform: scale(1); }\n          50% { opacity: 1; transform: scale(1.2); }\n        }\n        \n        @keyframes micPulse {\n          0% { \n            transform: translate(-50%, -50%) scale(1);\n            opacity: 0.7;\n          }\n          50% { \n            transform: translate(-50%, -50%) scale(2.4);\n            opacity: 0.3;\n          }\n          100% { \n            transform: translate(-50%, -50%) scale(1);\n            opacity: 0.7;\n          }\n        }\n        \n        /* Custom scrollbar for chat */\n        ::-webkit-scrollbar {\n          width: 4px;\n        }\n        ::-webkit-scrollbar-track {\n          background: rgba(0, 0, 0, 0.1);\n          border-radius: 2px;\n        }\n        ::-webkit-scrollbar-thumb {\n          background: rgba(0, 0, 0, 0.3);\n          border-radius: 2px;\n        }\n        ::-webkit-scrollbar-thumb:hover {\n          background: rgba(0, 0, 0, 0.5);\n        }\n        \n        /* Placeholder styling */\n        textarea::placeholder {\n          color: #666;\n        }\n      `})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","Avatar","jsx","_jsx","jsxs","_jsxs","App","messages","setMessages","role","content","inputMessage","setInputMessage","isLoading","setIsLoading","audioUrl","setAudioUrl","visemes","setVisemes","isPlaying","setIsPlaying","isMicActive","setIsMicActive","isListening","setIsListening","recognition","setRecognition","audioEnabled","setAudioEnabled","horizontalPadding","setHorizontalPadding","maxWidth","setMaxWidth","windowWidth","setWindowWidth","window","innerWidth","messagesEndRef","console","log","length","messagesCount","current","scrollIntoView","behavior","calculateLayout","screenWidth","fixedPadding","maxContentWidth","calculateAvatarScale","currentWidth","scale","handleResize","addEventListener","removeEventListener","enableAudio","audioPromise","Promise","resolve","reject","audioContext","AudioContext","webkitAudioContext","resume","audio","Audio","src","volume","oncanplaythrough","play","then","catch","error","warn","onerror","setTimeout","timeoutPromise","race","sendMessageToAI","messageText","trim","_data$visemes","backendUrl","process","env","REACT_APP_BACKEND_URL","response","fetch","method","headers","body","JSON","stringify","message","status","statusText","ok","errorText","text","Error","data","json","hasAudioUrl","hasVisemeData","visemeDataLength","visemeDataType","visemeDataValue","aiMessage","prev","_data$visemes2","_convertedVisemes","fullAudioUrl","convertedVisemes","map","viseme","timeMs","visemeId","lastVisemeTime","audioError","_data$visemes3","audioEnabledType","audioUrlType","responseKeys","Object","keys","conditionResults","audioEnabled_check","audioUrl_check","visemeData_check","overallCondition","name","stack","errorMessage","SpeechRecognition","webkitSpeechRecognition","recognitionInstance","continuous","interimResults","lang","onstart","onresult","event","transcript","results","userMessage","onend","sendMessage","messageToSend","handleKeyPress","e","key","shiftKey","preventDefault","toggleMicrophone","alert","stop","start","className","children","style","width","height","background","flexDirection","justifyContent","alignItems","display","boxSizing","position","flex","gap","paddingLeft","paddingRight","paddingTop","paddingBottom","margin","padding","minHeight","minWidth","alignSelf","borderRadius","overflow","flexGrow","flexShrink","flexBasis","backgroundSize","backgroundPosition","backgroundRepeat","isActive","isTalking","isThinking","overflowY","marginTop","marginBottom","index","backgroundColor","color","fontSize","lineHeight","boxShadow","textAlign","animation","marginLeft","ref","left","top","border","cursor","viewBox","fill","xmlns","d","id","x1","y1","x2","y2","gradientUnits","stopColor","offset","type","value","onChange","target","onKeyPress","onFocus","onBlur","onClick","placeholder","disabled","outline","fontFamily","right","transform","transition","onMouseEnter","onMouseLeave","cx","cy","r","stroke","strokeWidth","opacity","strokeLinecap","attributeName","attributeType","from","to","dur","repeatCount","strokeLinejoin","zIndex","fillRule","clipRule"],"sources":["/Users/pat/Desktop/Rive-Avatar-Web/ai-avatar-chat-production/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport Avatar from './Avatar';\nimport './App.css';\n\nfunction App() {\n  const [messages, setMessages] = useState([\n    { role: 'assistant', content: 'Hello! I\\'m your AI companion. How can I help you today?' }\n  ]);\n  const [inputMessage, setInputMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [audioUrl, setAudioUrl] = useState('');\n  const [visemes, setVisemes] = useState([]);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [isMicActive, setIsMicActive] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const [recognition, setRecognition] = useState(null);\n  const [audioEnabled, setAudioEnabled] = useState(false);\n  const [horizontalPadding, setHorizontalPadding] = useState(60);\n  const [maxWidth, setMaxWidth] = useState('100%');\n  const [windowWidth, setWindowWidth] = useState(typeof window !== 'undefined' ? window.innerWidth : 1200);\n\n  // Ref for auto-scrolling chat messages\n  const messagesEndRef = useRef(null);\n\n  // Debug render state\n  console.log('üîÑ App render state:', {\n    inputMessage: inputMessage.length,\n    isLoading,\n    isListening,\n    audioEnabled,\n    recognition: !!recognition,\n    messagesCount: messages.length\n  });\n\n  // Auto-scroll to bottom when messages change\n  useEffect(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n    }\n  }, [messages, isLoading]);\n\n  // Calculate responsive layout based on screen width\n  const calculateLayout = () => {\n    const screenWidth = typeof window !== 'undefined' ? window.innerWidth : 1200;\n    setWindowWidth(screenWidth);\n    \n    const fixedPadding = 60;\n    const maxContentWidth = 1080; // Fixed content width when centered\n    \n    if (screenWidth < 1080) {\n      // Mobile layout: stack vertically with full width\n      setHorizontalPadding(fixedPadding);\n      setMaxWidth('100%');\n      console.log(`üì± MOBILE MODE: Width=${screenWidth}px, Padding=${fixedPadding}px, MaxWidth=100%, Layout=Vertical`);\n    } else {\n      // Desktop layout: center the UI with fixed max width\n      setHorizontalPadding(fixedPadding);\n      setMaxWidth(`${maxContentWidth}px`);\n      console.log(`üñ•Ô∏è DESKTOP MODE: Width=${screenWidth}px, Padding=${fixedPadding}px, MaxWidth=${maxContentWidth}px, Layout=Horizontal`);\n    }\n  };\n\n  // Calculate avatar scale to completely fill the Avatar-MAIN panel\n  const calculateAvatarScale = () => {\n    // Use current window width directly if windowWidth state isn't ready\n    const currentWidth = windowWidth || (typeof window !== 'undefined' ? window.innerWidth : 1200);\n    \n    let scale;\n    if (currentWidth >= 1080) {\n      // Desktop: scale optimized for 4000x4000px high-res Rive file\n      scale = 1.8; // Reduced from 3.0 for high-resolution Rive file\n    } else {\n      // Mobile: scale optimized for 4000x4000px high-res Rive file\n      scale = 2.2; // Reduced from 4.5 for high-resolution Rive file\n    }\n    \n    console.log(`üîß Avatar Scale Calculation (4000px Rive): windowWidth=${windowWidth}, currentWidth=${currentWidth}, scale=${scale}`);\n    return scale;\n  };\n\n  // Update layout on mount and window resize\n  useEffect(() => {\n    // Ensure layout is calculated immediately on mount\n    calculateLayout();\n    \n    const handleResize = () => {\n      calculateLayout();\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  const enableAudio = useCallback(async () => {\n    try {\n      console.log('üîä Attempting to enable audio...');\n      \n      // Add timeout to prevent hanging\n      const audioPromise = new Promise(async (resolve, reject) => {\n        try {\n          // Create a dummy audio context to enable audio permissions\n          const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n          await audioContext.resume();\n          \n          // Create and play a silent audio to unlock autoplay\n          const audio = new Audio();\n          audio.src = 'data:audio/wav;base64,UklGRnoAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=';\n          audio.volume = 0.01; // Very low volume\n          \n          // Add event listeners to handle play result\n          audio.oncanplaythrough = () => {\n            audio.play().then(() => {\n              resolve(true);\n            }).catch((error) => {\n              console.warn('üîá Silent audio play failed:', error);\n              resolve(false); // Don't reject, just continue\n            });\n          };\n          \n          audio.onerror = () => {\n            console.warn('üîá Silent audio load failed');\n            resolve(false); // Don't reject, just continue\n          };\n          \n          // Fallback timeout\n          setTimeout(() => {\n            resolve(false);\n          }, 1000);\n          \n        } catch (error) {\n          reject(error);\n        }\n      });\n      \n      // Timeout the entire operation\n      const timeoutPromise = new Promise((resolve) => {\n        setTimeout(() => {\n          console.warn('‚è∞ Audio enablement timed out');\n          resolve(false);\n        }, 2000);\n      });\n      \n      await Promise.race([audioPromise, timeoutPromise]);\n      \n      setAudioEnabled(true); // Always enable audio - the test might fail but actual playback could work\n      console.log('‚úÖ Audio enabled (test may have failed but continuing anyway)');\n    } catch (error) {\n      console.warn('‚ùå Could not enable audio:', error);\n      setAudioEnabled(true); // Set to true anyway to allow the app to continue\n    }\n  }, []);\n\n  const sendMessageToAI = useCallback(async (messageText) => {\n    console.log('üì§ sendMessageToAI called with:', messageText);\n    if (!messageText.trim() || isLoading) {\n      console.log('‚ùå Message rejected - empty or loading');\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      console.log('üöÄ Sending message to API:', messageText);\n      const backendUrl = process.env.REACT_APP_BACKEND_URL || 'http://localhost:3006';\n      const response = await fetch(`${backendUrl}/api/chat`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          message: messageText\n        }),\n      });\n\n      console.log('üì° Response status:', response.status, response.statusText);\n      \n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error('‚ùå API Error Response:', errorText);\n        throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);\n      }\n\n      const data = await response.json();\n      console.log('‚úÖ API Response data:', data);\n      console.log('üîç FORCE DEBUG - Audio/Viseme check:', {\n        audioEnabled,\n        hasAudioUrl: !!data.audioUrl,\n        hasVisemeData: !!data.visemes,\n        audioUrl: data.audioUrl,\n        visemeDataLength: data.visemes?.length,\n        visemeDataType: typeof data.visemes,\n        visemeDataValue: data.visemes\n      });\n      \n      // Add AI response to chat\n      const aiMessage = { role: 'assistant', content: data.response || data.text || data.message };\n      setMessages(prev => [...prev, aiMessage]);\n\n      // Check if response includes audio and visemes (new format from our backend)\n      // Always process audio if available, since user has already enabled it by sending a message\n      if (data.audioUrl && data.visemes) {\n        try {\n          console.log('üéµ Processing response with audio and visemes...');\n          console.log('üéµ Audio URL:', data.audioUrl);\n          console.log('üéµ Viseme data count:', data.visemes?.length || 0);\n          \n          // Create full audio URL from relative path\n          const backendUrl = process.env.REACT_APP_BACKEND_URL || 'http://localhost:3006';\n          const fullAudioUrl = `${backendUrl}${data.audioUrl}`;\n          \n          // Convert viseme format to the format expected by Avatar component\n          const convertedVisemes = data.visemes.map(viseme => ({\n            timeMs: viseme.timeMs,\n            visemeId: viseme.visemeId\n          }));\n          \n          console.log('üéµ Setting audio and visemes:', fullAudioUrl, convertedVisemes.length, 'visemes');\n          setAudioUrl(fullAudioUrl);\n          setVisemes(convertedVisemes);\n          setIsPlaying(true);\n          \n          // Reset playing state after audio duration (estimated from last viseme)\n          const lastVisemeTime = convertedVisemes[convertedVisemes.length - 1]?.timeMs || 3000;\n          setTimeout(() => {\n            setIsPlaying(false);\n          }, lastVisemeTime + 1000);\n          \n        } catch (audioError) {\n          console.error('‚ùå Error processing audio/visemes:', audioError);\n        }\n      } else {\n        console.log('üí¨ No audio/visemes in response - text-only chat mode');\n        console.log('üîç Detailed debugging:', {\n          audioEnabled: audioEnabled,\n          audioEnabledType: typeof audioEnabled,\n          hasAudioUrl: !!data.audioUrl,\n          hasVisemeData: !!data.visemes,\n          audioUrlType: typeof data.audioUrl,\n          visemeDataType: typeof data.visemes,\n          audioUrl: data.audioUrl || 'none',\n          visemeDataLength: data.visemes?.length || 0,\n          responseKeys: Object.keys(data),\n          conditionResults: {\n            audioEnabled_check: !!audioEnabled,\n            audioUrl_check: !!data.audioUrl,\n            visemeData_check: !!data.visemes,\n            overallCondition: !!(audioEnabled && data.audioUrl && data.visemes)\n          }\n        });\n      }\n\n    } catch (error) {\n      console.error('‚ùå Error sending message - Full error object:', error);\n      console.error('‚ùå Error name:', error.name);\n      console.error('‚ùå Error message:', error.message);\n      console.error('‚ùå Error stack:', error.stack);\n      const errorMessage = { role: 'assistant', content: `Sorry, I encountered an error: ${error.message}. Please try again.` };\n      setMessages(prev => [...prev, errorMessage]);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [isLoading, audioEnabled]);\n\n  // Initialize speech recognition\n  useEffect(() => {\n    console.log('üé§ Initializing speech recognition...');\n    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\n      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n      const recognitionInstance = new SpeechRecognition();\n      \n      recognitionInstance.continuous = false;\n      recognitionInstance.interimResults = false;\n      recognitionInstance.lang = 'en-US';\n      \n      recognitionInstance.onstart = () => {\n        console.log('üé§ Speech recognition started');\n        setIsListening(true);\n      };\n      \n      recognitionInstance.onresult = (event) => {\n        const transcript = event.results[0][0].transcript;\n        console.log('üó£Ô∏è Speech recognition result:', transcript);\n        \n        // Instead of setting input, directly send the message\n        if (transcript.trim()) {\n          // Add user message to chat immediately\n          const userMessage = { role: 'user', content: transcript };\n          setMessages(prev => [...prev, userMessage]);\n          \n          // Send to AI backend\n          sendMessageToAI(transcript);\n        }\n        \n        setIsListening(false);\n        setIsMicActive(false);\n      };\n      \n      recognitionInstance.onerror = (event) => {\n        console.error('‚ùå Speech recognition error:', event.error);\n        setIsListening(false);\n        setIsMicActive(false);\n      };\n      \n      recognitionInstance.onend = () => {\n        console.log('üõë Speech recognition ended');\n        setIsListening(false);\n        setIsMicActive(false);\n      };\n      \n      setRecognition(recognitionInstance);\n      console.log('‚úÖ Speech recognition initialized');\n    } else {\n      console.warn('‚ö†Ô∏è Speech recognition not supported in this browser');\n    }\n  }, [sendMessageToAI]);\n\n  const sendMessage = useCallback(async () => {\n    console.log('üìù sendMessage called with inputMessage:', inputMessage);\n    if (!inputMessage.trim() || isLoading) {\n      console.log('‚ùå sendMessage rejected - empty or loading');\n      return;\n    }\n\n    // Enable audio on user interaction (immediately, don't wait)\n    if (!audioEnabled) {\n      console.log('üîä First interaction - enabling audio immediately...');\n      setAudioEnabled(true); // Set immediately for faster response\n      enableAudio().catch(error => {\n        console.warn('üîá Audio enabling failed but continuing:', error);\n      });\n    }\n\n    // Add user message to chat\n    const userMessage = { role: 'user', content: inputMessage };\n    setMessages(prev => [...prev, userMessage]);\n    \n    // Send to AI and clear input\n    const messageToSend = inputMessage;\n    setInputMessage('');\n    \n    // Don't await audio enabling, just continue\n    console.log('üöÄ Proceeding to send message to AI...');\n    await sendMessageToAI(messageToSend);\n  }, [inputMessage, isLoading, audioEnabled, enableAudio, sendMessageToAI]);\n\n  const handleKeyPress = useCallback((e) => {\n    console.log('‚å®Ô∏è Key pressed:', e.key);\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  }, [sendMessage]);\n\n  const toggleMicrophone = useCallback(async () => {\n    console.log('üé§ toggleMicrophone called, recognition available:', !!recognition);\n    if (!recognition) {\n      alert('Speech recognition is not supported in this browser. Please use Chrome, Safari, or Edge.');\n      return;\n    }\n\n    // Enable audio on user interaction (immediately, don't wait)\n    if (!audioEnabled) {\n      console.log('üîä First microphone interaction - enabling audio immediately...');\n      setAudioEnabled(true); // Set immediately for faster response\n      enableAudio().catch(error => {\n        console.warn('üîá Audio enabling failed but continuing:', error);\n      });\n    }\n\n    if (isListening) {\n      // Stop listening\n      console.log('üõë Stopping speech recognition');\n      recognition.stop();\n      setIsListening(false);\n      setIsMicActive(false);\n    } else {\n      // Start listening\n      try {\n        console.log('üé§ Starting speech recognition');\n        recognition.start();\n        setIsMicActive(true);\n      } catch (error) {\n        console.error('‚ùå Error starting speech recognition:', error);\n        alert('Error starting microphone. Please check your microphone permissions.');\n        setIsMicActive(false);\n      }\n    }\n  }, [recognition, audioEnabled, enableAudio, isListening]);\n\n  return (\n    <div className=\"App\">\n      \n      {/* Exact Figma Design Implementation */}\n      <div style={{\n        width: '100%', \n        height: '100vh', \n        background: '#7C7C7C', \n        flexDirection: 'column', \n        justifyContent: 'flex-start', \n        alignItems: 'center', \n        display: 'flex',\n        boxSizing: 'border-box'\n      }}>\n        \n        {/* Main Section - Avatar and Chat Panel */}\n        <div style={{\n          width: '100%',\n          position: 'relative',\n          flex: 1, // Allow this section to grow and fill available space\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center'\n        }}>\n          <div style={{\n            display: 'flex',\n            flexDirection: 'row',\n            alignItems: 'center',\n            justifyContent: 'center',\n            position: 'relative',\n            width: '100%',\n            height: '100%'\n          }}>\n            <div style={{\n              boxSizing: 'border-box',\n              display: 'flex',\n              flexDirection: windowWidth < 1080 ? 'column' : 'row', // Stack vertically on mobile\n              gap: 20,\n              alignItems: windowWidth < 1080 ? 'stretch' : 'center', // Stretch full width on mobile\n              justifyContent: 'center',\n              paddingLeft: horizontalPadding,\n              paddingRight: horizontalPadding,\n              paddingTop: 20,\n              paddingBottom: 20,\n              position: 'relative',\n              width: '100%',\n              maxWidth: maxWidth,\n              margin: '0 auto'\n            }}>\n              \n              {/* Avatar-MAIN */}\n              <div style={{\n                flex: windowWidth < 1080 ? '0 0 auto' : '0 0 450px',\n                height: windowWidth < 1080 ? 350 : 460,\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'flex-start',\n                justifyContent: 'center',\n                padding: 0,\n                position: 'relative',\n                minHeight: windowWidth < 1080 ? '300px' : '350px',\n                minWidth: windowWidth < 1080 ? '100%' : '330px',\n                width: windowWidth < 1080 ? '100%' : 'auto'\n              }}>\n                <div style={{\n                  alignSelf: 'stretch',\n                  height: windowWidth < 1080 ? 350 : 460,\n                  borderRadius: 32,\n                  overflow: 'hidden',\n                  position: 'relative',\n                  width: '100%',\n                  flexGrow: 1,\n                  flexShrink: 0,\n                  flexBasis: 0,\n                  minHeight: windowWidth < 1080 ? '300px' : '380px',\n                  minWidth: windowWidth < 1080 ? '100%' : '350px',\n                  maxWidth: windowWidth < 1080 ? '100%' : '450px',\n                  backgroundSize: 'cover',\n                  backgroundPosition: 'center',\n                  backgroundRepeat: 'no-repeat'\n                }}>\n                  <Avatar\n                    key={`avatar-${calculateAvatarScale()}`} // Force re-render when scale changes\n                    isActive={true}\n                    isTalking={isPlaying}\n                    isThinking={isLoading}\n                    visemes={visemes}\n                    audioUrl={audioUrl}\n                    audioEnabled={audioEnabled}\n                    scale={calculateAvatarScale()}\n                  />\n                </div>\n              </div>\n              \n              {/* Main-Panel */}\n              <div style={{\n                flex: windowWidth < 1080 ? '0 0 auto' : '1 1 0',\n                height: windowWidth < 1080 ? 350 : 460,\n                background: '#D9D9D9',\n                borderRadius: 32,\n                minHeight: windowWidth < 1080 ? '350px' : '460px',\n                minWidth: windowWidth < 1080 ? '100%' : '1px',\n                width: windowWidth < 1080 ? '100%' : 'auto',\n                padding: windowWidth < 1080 ? '0px' : '0px 20px',\n                display: 'flex',\n                flexDirection: 'column',\n                overflow: 'hidden'\n              }}>\n                \n                {/* Chat Messages Area */}\n                <div style={{\n                  flex: 1,\n                  overflowY: 'auto',\n                  display: 'flex',\n                  flexDirection: 'column',\n                  gap: '12px',\n                  marginTop: '20px',\n                  marginBottom: '20px',\n                  paddingLeft: windowWidth < 1080 ? '20px' : '0px',\n                  paddingRight: windowWidth < 1080 ? '20px' : '0px'\n                }}>\n                  {messages.map((message, index) => (\n                    <div key={index} style={{\n                      display: 'flex',\n                      justifyContent: message.role === 'user' ? 'flex-end' : 'flex-start',\n                      alignItems: 'flex-start'\n                    }}>\n                      <div style={{\n                        maxWidth: '80%',\n                        padding: '12px 16px',\n                        borderRadius: message.role === 'user' ? '16px 16px 4px 16px' : '16px 16px 16px 4px',\n                        backgroundColor: message.role === 'user' ? '#007AFF' : 'white',\n                        color: message.role === 'user' ? 'white' : '#333',\n                        fontSize: '14px',\n                        lineHeight: '1.4',\n                        boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\n                        textAlign: message.role === 'user' ? 'right' : 'left'\n                      }}>\n                        {message.content}\n                      </div>\n                    </div>\n                  ))}\n                  \n                  {isLoading && (\n                    <div style={{\n                      display: 'flex',\n                      justifyContent: 'flex-start',\n                      alignItems: 'flex-start'\n                    }}>\n                      <div style={{\n                        padding: '12px 16px',\n                        borderRadius: '16px 16px 16px 4px',\n                        backgroundColor: 'white',\n                        color: '#666',\n                        fontSize: '14px',\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '6px',\n                        boxShadow: '0 1px 3px rgba(0,0,0,0.1)'\n                      }}>\n                        <div style={{\n                          width: '4px',\n                          height: '4px',\n                          borderRadius: '50%',\n                          backgroundColor: '#666',\n                          animation: 'pulse 1.5s infinite'\n                        }} />\n                        <div style={{\n                          width: '4px',\n                          height: '4px',\n                          borderRadius: '50%',\n                          backgroundColor: '#666',\n                          animation: 'pulse 1.5s infinite 0.2s'\n                        }} />\n                        <div style={{\n                          width: '4px',\n                          height: '4px',\n                          borderRadius: '50%',\n                          backgroundColor: '#666',\n                          animation: 'pulse 1.5s infinite 0.4s'\n                        }} />\n                        <span style={{ marginLeft: '6px' }}>Thinking...</span>\n                      </div>\n                    </div>\n                  )}\n                  \n                  {/* Invisible element to scroll to */}\n                  <div ref={messagesEndRef} style={{ height: '1px' }} />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        {/* Composer Section */}\n        <div style={{\n          width: '100%',\n          position: 'relative',\n          flexShrink: 0,\n          marginTop: 'auto' // Push to bottom\n        }}>\n          <div style={{\n            display: 'flex',\n            flexDirection: 'row',\n            alignItems: 'center',\n            position: 'relative',\n            width: '100%',\n            height: '100%'\n          }}>\n            <div style={{\n              boxSizing: 'border-box',\n              display: 'flex',\n              flexDirection: 'row',\n              gap: 11,\n              alignItems: 'center',\n              justifyContent: 'flex-start',\n              paddingLeft: horizontalPadding,\n              paddingRight: horizontalPadding,\n              paddingTop: 0,\n              paddingBottom: 20,\n              position: 'relative',\n              width: '100%',\n              maxWidth: maxWidth,\n              margin: '0 auto'\n            }}>\n              \n              {/* Search Button */}\n              <div style={{\n                position: 'relative',\n                flexShrink: 0,\n                width: 48,\n                height: 48\n              }}>\n                <button style={{\n                  position: 'absolute',\n                  left: 0,\n                  top: 0,\n                  width: 48,\n                  height: 48,\n                  background: 'transparent',\n                  borderRadius: 24,\n                  border: 'none',\n                  cursor: 'pointer',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                }}>\n                  <svg \n                    width=\"25\" \n                    height=\"25\" \n                    viewBox=\"0 0 25 25\" \n                    fill=\"none\" \n                    xmlns=\"http://www.w3.org/2000/svg\"\n                  >\n                    <path \n                      d=\"M24.6266 22.823C25.1243 23.3209 25.1243 24.1287 24.6266 24.6266C24.1287 25.1245 23.321 25.1243 22.823 24.6266L24.6266 22.823ZM11.1575 0.0138357C16.7639 0.298223 21.222 4.93396 21.222 10.611L21.2082 11.1575C21.0936 13.4163 20.2716 15.4878 18.9609 17.1573L19.5262 17.7236L24.6266 22.823L23.7243 23.7243L22.823 24.6266L17.7236 19.5262L17.1573 18.9609C15.354 20.3766 13.0815 21.222 10.611 21.222L10.0655 21.2082C4.63969 20.9334 0.289055 16.5832 0.0138357 11.1575L0 10.611C4.90281e-05 4.75073 4.75073 4.64216e-05 10.611 0L11.1575 0.0138357ZM10.611 1.60297C5.63604 1.60301 1.60302 5.63603 1.60297 10.611C1.60297 15.586 5.63601 19.619 10.611 19.619C15.586 19.619 19.619 15.5861 19.619 10.611C19.619 5.636 15.586 1.60297 10.611 1.60297Z\" \n                      fill=\"url(#paint0_linear_12_78)\"\n                    />\n                    <defs>\n                      <linearGradient \n                        id=\"paint0_linear_12_78\" \n                        x1=\"4.59026\" \n                        y1=\"3.98128\" \n                        x2=\"18.4429\" \n                        y2=\"19.5244\" \n                        gradientUnits=\"userSpaceOnUse\"\n                      >\n                        <stop stopColor=\"white\"/>\n                        <stop offset=\"1\" stopColor=\"#E8E8E8\"/>\n                      </linearGradient>\n                    </defs>\n                  </svg>\n                </button>\n              </div>\n              \n              {/* Input Field */}\n              <div style={{\n                flexGrow: 1,\n                flexShrink: 0,\n                flexBasis: 0,\n                height: 56,\n                background: '#FFFFFF',\n                borderRadius: 28,\n                minHeight: '1px',\n                minWidth: '1px',\n                position: 'relative',\n                display: 'flex',\n                alignItems: 'center',\n                boxShadow: '0 2px 4px rgba(0,0,0,0.1)'\n              }}>\n                <input\n                  type=\"text\"\n                  value={inputMessage}\n                  onChange={(e) => {\n                    console.log('üìù Input changed:', e.target.value);\n                    setInputMessage(e.target.value);\n                  }}\n                  onKeyPress={handleKeyPress}\n                  onFocus={() => console.log('üéØ Input focused')}\n                  onBlur={() => console.log('üëã Input blurred')}\n                  onClick={() => console.log('üñ±Ô∏è Input clicked')}\n                  placeholder={\n                    isListening \n                      ? \"Listening...\" \n                      : \"Ask me anything...\"\n                  }\n                  disabled={isLoading || isListening}\n                  style={{\n                    width: '100%',\n                    height: '100%',\n                    padding: '0px 60px 0px 20px', // No top/bottom padding needed for input\n                    border: 'none',\n                    borderRadius: 32,\n                    fontSize: '16px',\n                    lineHeight: '24px',\n                    outline: 'none',\n                    fontFamily: 'inherit',\n                    backgroundColor: 'transparent',\n                    color: '#333'\n                  }}\n                />\n                \n                {/* Send Button inside input */}\n                <button\n                  onClick={() => {\n                    console.log('üì§ Send button clicked');\n                    sendMessage();\n                  }}\n                  disabled={!inputMessage.trim() || isLoading || isListening}\n                  style={{\n                    position: 'absolute',\n                    right: '12px',\n                    top: '50%',\n                    transform: 'translateY(-50%)',\n                    width: '32px',\n                    height: '32px',\n                    borderRadius: '50%',\n                    border: 'none',\n                    background: (!inputMessage.trim() || isLoading || isListening) ? '#999' : '#007AFF',\n                    cursor: (!inputMessage.trim() || isLoading || isListening) ? 'not-allowed' : 'pointer',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    transition: 'all 0.2s ease',\n                    boxShadow: '0 2px 4px rgba(0,0,0,0.1)'\n                  }}\n                  onMouseEnter={(e) => {\n                    if (inputMessage.trim() && !isLoading && !isListening) {\n                      e.target.style.transform = 'translateY(-50%) scale(1.1)';\n                    }\n                  }}\n                  onMouseLeave={(e) => {\n                    if (inputMessage.trim() && !isLoading && !isListening) {\n                      e.target.style.transform = 'translateY(-50%)';\n                    }\n                  }}\n                >\n                  {isLoading ? (\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\">\n                      <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"white\" strokeWidth=\"2\" opacity=\"0.3\" />\n                      <path \n                        d=\"M12 2C13.3132 2 14.6136 2.25866 15.8268 2.7612C17.0401 3.26375 18.1425 4.00035 19.0711 4.92893C19.9997 5.85752 20.7362 6.95991 21.2388 8.17317C21.7413 9.38642 22 10.6868 22 12\"\n                        stroke=\"white\" \n                        strokeWidth=\"2\"\n                        strokeLinecap=\"round\"\n                      >\n                        <animateTransform\n                          attributeName=\"transform\"\n                          attributeType=\"XML\"\n                          type=\"rotate\"\n                          from=\"0 12 12\"\n                          to=\"360 12 12\"\n                          dur=\"1s\"\n                          repeatCount=\"indefinite\"\n                        />\n                      </path>\n                    </svg>\n                  ) : (\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\">\n                      <path \n                        d=\"M5 12H19M19 12L13 6M19 12L13 18\" \n                        stroke=\"white\" \n                        strokeWidth=\"2\" \n                        strokeLinecap=\"round\" \n                        strokeLinejoin=\"round\"\n                      />\n                    </svg>\n                  )}\n                </button>\n              </div>\n              \n              {/* Right Buttons Group */}\n              <div style={{\n                boxSizing: 'border-box',\n                display: 'flex',\n                flexDirection: 'row',\n                gap: 11,\n                alignItems: 'center',\n                justifyContent: 'flex-end',\n                padding: 0,\n                position: 'relative',\n                flexShrink: 0\n              }}>\n                {/* Microphone Button */}\n                <div style={{\n                  position: 'relative',\n                  flexShrink: 0,\n                  width: 48,\n                  height: 48\n                }}>\n                  <button \n                    onClick={() => {\n                      console.log('üé§ Microphone button clicked');\n                      toggleMicrophone();\n                    }}\n                    style={{\n                      position: 'absolute',\n                      background: isListening ? '#FF3B30' : '#FFFFFF',\n                      left: 0,\n                      top: 0,\n                      borderRadius: 24,\n                      width: 48,\n                      height: 48,\n                      border: 'none',\n                      cursor: 'pointer',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      boxShadow: isListening ? '0 4px 12px rgba(255, 59, 48, 0.3)' : '0 2px 4px rgba(0,0,0,0.1)',\n                      transition: 'all 0.2s ease',\n                      transform: isListening ? 'scale(1.1)' : 'scale(1)',\n                      overflow: 'hidden' // Ensure the pulse animation is masked by the circular button\n                    }}\n                  >\n                    {/* Pulsating background animation */}\n                    {(isMicActive || isListening) && (\n                      <div\n                        style={{\n                          position: 'absolute',\n                          top: '50%',\n                          left: '50%',\n                          width: '20px',\n                          height: '20px',\n                          background: isListening ? 'rgba(255, 255, 255, 0.3)' : 'rgba(0, 122, 255, 0.3)',\n                          borderRadius: '50%',\n                          transform: 'translate(-50%, -50%)',\n                          animation: 'micPulse 2s infinite ease-in-out',\n                          zIndex: 1\n                        }}\n                      />\n                    )}\n                    \n                    <svg \n                      width=\"23\" \n                      height=\"27\" \n                      viewBox=\"0 0 23 27\" \n                      fill=\"none\" \n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      style={{ position: 'relative', zIndex: 2 }}\n                    >\n                      <path \n                        fillRule=\"evenodd\" \n                        clipRule=\"evenodd\" \n                        d=\"M17.7428 6.24286C17.7428 2.79501 14.9478 0 11.4999 0C8.05215 0 5.25714 2.79503 5.25714 6.24286V15.4428C5.25714 18.8907 8.05215 21.6857 11.4999 21.6857C14.9478 21.6857 17.7428 18.8907 17.7428 15.4428V6.24286ZM11.4999 1.97143C13.8591 1.97143 15.7714 3.88381 15.7714 6.24286V15.4428C15.7714 17.8018 13.8591 19.7143 11.4999 19.7143C9.14093 19.7143 7.22856 17.8018 7.22856 15.4428V6.24286C7.22856 3.88381 9.14093 1.97143 11.4999 1.97143Z\" \n                        fill={isListening ? \"#FFFFFF\" : \"#33302E\"}\n                      />\n                      <path \n                        fillRule=\"evenodd\" \n                        clipRule=\"evenodd\" \n                        d=\"M22.0142 9.19999C21.4698 9.19999 21.0285 9.64131 21.0285 10.1857V15.4428C21.0285 20.7053 16.7624 24.9714 11.4999 24.9714C6.23751 24.9714 1.97143 20.7053 1.97143 15.4428V10.1857C1.97143 9.64131 1.5301 9.19999 0.985708 9.19999C0.441311 9.19999 0 9.64131 0 10.1857V15.4428C0 21.7941 5.14872 26.9429 11.4999 26.9429C17.8512 26.9429 23 21.7941 23 15.4428V10.1857C23 9.64131 22.5587 9.19999 22.0142 9.19999Z\" \n                        fill={isListening ? \"#FFFFFF\" : \"#33302E\"}\n                      />\n                    </svg>\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n      </div>\n\n      {/* CSS for animations and exact Figma styling */}\n      <style>{`\n        .App {\n          width: 100vw;\n          height: 100vh;\n          margin: 0;\n          padding: 0;\n        }\n        \n        body {\n          margin: 0;\n          padding: 0;\n          width: 100%;\n          height: 100%;\n        }\n        \n        #root {\n          width: 100%;\n          height: 100%;\n        }\n        \n        @keyframes pulse {\n          0%, 100% { opacity: 0.5; transform: scale(1); }\n          50% { opacity: 1; transform: scale(1.2); }\n        }\n        \n        @keyframes micPulse {\n          0% { \n            transform: translate(-50%, -50%) scale(1);\n            opacity: 0.7;\n          }\n          50% { \n            transform: translate(-50%, -50%) scale(2.4);\n            opacity: 0.3;\n          }\n          100% { \n            transform: translate(-50%, -50%) scale(1);\n            opacity: 0.7;\n          }\n        }\n        \n        /* Custom scrollbar for chat */\n        ::-webkit-scrollbar {\n          width: 4px;\n        }\n        ::-webkit-scrollbar-track {\n          background: rgba(0, 0, 0, 0.1);\n          border-radius: 2px;\n        }\n        ::-webkit-scrollbar-thumb {\n          background: rgba(0, 0, 0, 0.3);\n          border-radius: 2px;\n        }\n        ::-webkit-scrollbar-thumb:hover {\n          background: rgba(0, 0, 0, 0.5);\n        }\n        \n        /* Placeholder styling */\n        textarea::placeholder {\n          color: #666;\n        }\n      `}</style>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,WAAW,CAAEC,MAAM,KAAQ,OAAO,CACvE,MAAO,CAAAC,MAAM,KAAM,UAAU,CAC7B,MAAO,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnB,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGX,QAAQ,CAAC,CACvC,CAAEY,IAAI,CAAE,WAAW,CAAEC,OAAO,CAAE,0DAA2D,CAAC,CAC3F,CAAC,CACF,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACgB,SAAS,CAAEC,YAAY,CAAC,CAAGjB,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACkB,QAAQ,CAAEC,WAAW,CAAC,CAAGnB,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACoB,OAAO,CAAEC,UAAU,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACsB,SAAS,CAAEC,YAAY,CAAC,CAAGvB,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACwB,WAAW,CAAEC,cAAc,CAAC,CAAGzB,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAAC0B,WAAW,CAAEC,cAAc,CAAC,CAAG3B,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAAC4B,WAAW,CAAEC,cAAc,CAAC,CAAG7B,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAAC8B,YAAY,CAAEC,eAAe,CAAC,CAAG/B,QAAQ,CAAC,KAAK,CAAC,CACvD,KAAM,CAACgC,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGjC,QAAQ,CAAC,EAAE,CAAC,CAC9D,KAAM,CAACkC,QAAQ,CAAEC,WAAW,CAAC,CAAGnC,QAAQ,CAAC,MAAM,CAAC,CAChD,KAAM,CAACoC,WAAW,CAAEC,cAAc,CAAC,CAAGrC,QAAQ,CAAC,MAAO,CAAAsC,MAAM,GAAK,WAAW,CAAGA,MAAM,CAACC,UAAU,CAAG,IAAI,CAAC,CAExG;AACA,KAAM,CAAAC,cAAc,CAAGrC,MAAM,CAAC,IAAI,CAAC,CAEnC;AACAsC,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAE,CAClC5B,YAAY,CAAEA,YAAY,CAAC6B,MAAM,CACjC3B,SAAS,CACTU,WAAW,CACXI,YAAY,CACZF,WAAW,CAAE,CAAC,CAACA,WAAW,CAC1BgB,aAAa,CAAElC,QAAQ,CAACiC,MAC1B,CAAC,CAAC,CAEF;AACA1C,SAAS,CAAC,IAAM,CACd,GAAIuC,cAAc,CAACK,OAAO,CAAE,CAC1BL,cAAc,CAACK,OAAO,CAACC,cAAc,CAAC,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CAC/D,CACF,CAAC,CAAE,CAACrC,QAAQ,CAAEM,SAAS,CAAC,CAAC,CAEzB;AACA,KAAM,CAAAgC,eAAe,CAAGA,CAAA,GAAM,CAC5B,KAAM,CAAAC,WAAW,CAAG,MAAO,CAAAX,MAAM,GAAK,WAAW,CAAGA,MAAM,CAACC,UAAU,CAAG,IAAI,CAC5EF,cAAc,CAACY,WAAW,CAAC,CAE3B,KAAM,CAAAC,YAAY,CAAG,EAAE,CACvB,KAAM,CAAAC,eAAe,CAAG,IAAI,CAAE;AAE9B,GAAIF,WAAW,CAAG,IAAI,CAAE,CACtB;AACAhB,oBAAoB,CAACiB,YAAY,CAAC,CAClCf,WAAW,CAAC,MAAM,CAAC,CACnBM,OAAO,CAACC,GAAG,CAAC,yBAAyBO,WAAW,eAAeC,YAAY,oCAAoC,CAAC,CAClH,CAAC,IAAM,CACL;AACAjB,oBAAoB,CAACiB,YAAY,CAAC,CAClCf,WAAW,CAAC,GAAGgB,eAAe,IAAI,CAAC,CACnCV,OAAO,CAACC,GAAG,CAAC,2BAA2BO,WAAW,eAAeC,YAAY,gBAAgBC,eAAe,uBAAuB,CAAC,CACtI,CACF,CAAC,CAED;AACA,KAAM,CAAAC,oBAAoB,CAAGA,CAAA,GAAM,CACjC;AACA,KAAM,CAAAC,YAAY,CAAGjB,WAAW,GAAK,MAAO,CAAAE,MAAM,GAAK,WAAW,CAAGA,MAAM,CAACC,UAAU,CAAG,IAAI,CAAC,CAE9F,GAAI,CAAAe,KAAK,CACT,GAAID,YAAY,EAAI,IAAI,CAAE,CACxB;AACAC,KAAK,CAAG,GAAG,CAAE;AACf,CAAC,IAAM,CACL;AACAA,KAAK,CAAG,GAAG,CAAE;AACf,CAEAb,OAAO,CAACC,GAAG,CAAC,0DAA0DN,WAAW,kBAAkBiB,YAAY,WAAWC,KAAK,EAAE,CAAC,CAClI,MAAO,CAAAA,KAAK,CACd,CAAC,CAED;AACArD,SAAS,CAAC,IAAM,CACd;AACA+C,eAAe,CAAC,CAAC,CAEjB,KAAM,CAAAO,YAAY,CAAGA,CAAA,GAAM,CACzBP,eAAe,CAAC,CAAC,CACnB,CAAC,CAEDV,MAAM,CAACkB,gBAAgB,CAAC,QAAQ,CAAED,YAAY,CAAC,CAC/C,MAAO,IAAMjB,MAAM,CAACmB,mBAAmB,CAAC,QAAQ,CAAEF,YAAY,CAAC,CACjE,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAG,WAAW,CAAGxD,WAAW,CAAC,SAAY,CAC1C,GAAI,CACFuC,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAC,CAE/C;AACA,KAAM,CAAAiB,YAAY,CAAG,GAAI,CAAAC,OAAO,CAAC,MAAOC,OAAO,CAAEC,MAAM,GAAK,CAC1D,GAAI,CACF;AACA,KAAM,CAAAC,YAAY,CAAG,IAAKzB,MAAM,CAAC0B,YAAY,EAAI1B,MAAM,CAAC2B,kBAAkB,EAAE,CAAC,CAC7E,KAAM,CAAAF,YAAY,CAACG,MAAM,CAAC,CAAC,CAE3B;AACA,KAAM,CAAAC,KAAK,CAAG,GAAI,CAAAC,KAAK,CAAC,CAAC,CACzBD,KAAK,CAACE,GAAG,CAAG,oFAAoF,CAChGF,KAAK,CAACG,MAAM,CAAG,IAAI,CAAE;AAErB;AACAH,KAAK,CAACI,gBAAgB,CAAG,IAAM,CAC7BJ,KAAK,CAACK,IAAI,CAAC,CAAC,CAACC,IAAI,CAAC,IAAM,CACtBZ,OAAO,CAAC,IAAI,CAAC,CACf,CAAC,CAAC,CAACa,KAAK,CAAEC,KAAK,EAAK,CAClBlC,OAAO,CAACmC,IAAI,CAAC,8BAA8B,CAAED,KAAK,CAAC,CACnDd,OAAO,CAAC,KAAK,CAAC,CAAE;AAClB,CAAC,CAAC,CACJ,CAAC,CAEDM,KAAK,CAACU,OAAO,CAAG,IAAM,CACpBpC,OAAO,CAACmC,IAAI,CAAC,6BAA6B,CAAC,CAC3Cf,OAAO,CAAC,KAAK,CAAC,CAAE;AAClB,CAAC,CAED;AACAiB,UAAU,CAAC,IAAM,CACfjB,OAAO,CAAC,KAAK,CAAC,CAChB,CAAC,CAAE,IAAI,CAAC,CAEV,CAAE,MAAOc,KAAK,CAAE,CACdb,MAAM,CAACa,KAAK,CAAC,CACf,CACF,CAAC,CAAC,CAEF;AACA,KAAM,CAAAI,cAAc,CAAG,GAAI,CAAAnB,OAAO,CAAEC,OAAO,EAAK,CAC9CiB,UAAU,CAAC,IAAM,CACfrC,OAAO,CAACmC,IAAI,CAAC,8BAA8B,CAAC,CAC5Cf,OAAO,CAAC,KAAK,CAAC,CAChB,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAAC,CAEF,KAAM,CAAAD,OAAO,CAACoB,IAAI,CAAC,CAACrB,YAAY,CAAEoB,cAAc,CAAC,CAAC,CAElDhD,eAAe,CAAC,IAAI,CAAC,CAAE;AACvBU,OAAO,CAACC,GAAG,CAAC,8DAA8D,CAAC,CAC7E,CAAE,MAAOiC,KAAK,CAAE,CACdlC,OAAO,CAACmC,IAAI,CAAC,2BAA2B,CAAED,KAAK,CAAC,CAChD5C,eAAe,CAAC,IAAI,CAAC,CAAE;AACzB,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAkD,eAAe,CAAG/E,WAAW,CAAC,KAAO,CAAAgF,WAAW,EAAK,CACzDzC,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAEwC,WAAW,CAAC,CAC3D,GAAI,CAACA,WAAW,CAACC,IAAI,CAAC,CAAC,EAAInE,SAAS,CAAE,CACpCyB,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC,CACpD,OACF,CAEAzB,YAAY,CAAC,IAAI,CAAC,CAElB,GAAI,KAAAmE,aAAA,CACF3C,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAEwC,WAAW,CAAC,CACtD,KAAM,CAAAG,UAAU,CAAGC,OAAO,CAACC,GAAG,CAACC,qBAAqB,EAAI,uBAAuB,CAC/E,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,GAAGL,UAAU,WAAW,CAAE,CACrDM,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,OAAO,CAAEd,WACX,CAAC,CACH,CAAC,CAAC,CAEFzC,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAE+C,QAAQ,CAACQ,MAAM,CAAER,QAAQ,CAACS,UAAU,CAAC,CAExE,GAAI,CAACT,QAAQ,CAACU,EAAE,CAAE,CAChB,KAAM,CAAAC,SAAS,CAAG,KAAM,CAAAX,QAAQ,CAACY,IAAI,CAAC,CAAC,CACvC5D,OAAO,CAACkC,KAAK,CAAC,uBAAuB,CAAEyB,SAAS,CAAC,CACjD,KAAM,IAAI,CAAAE,KAAK,CAAC,uBAAuBb,QAAQ,CAACQ,MAAM,cAAcG,SAAS,EAAE,CAAC,CAClF,CAEA,KAAM,CAAAG,IAAI,CAAG,KAAM,CAAAd,QAAQ,CAACe,IAAI,CAAC,CAAC,CAClC/D,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAE6D,IAAI,CAAC,CACzC9D,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAE,CAClDZ,YAAY,CACZ2E,WAAW,CAAE,CAAC,CAACF,IAAI,CAACrF,QAAQ,CAC5BwF,aAAa,CAAE,CAAC,CAACH,IAAI,CAACnF,OAAO,CAC7BF,QAAQ,CAAEqF,IAAI,CAACrF,QAAQ,CACvByF,gBAAgB,EAAAvB,aAAA,CAAEmB,IAAI,CAACnF,OAAO,UAAAgE,aAAA,iBAAZA,aAAA,CAAczC,MAAM,CACtCiE,cAAc,CAAE,MAAO,CAAAL,IAAI,CAACnF,OAAO,CACnCyF,eAAe,CAAEN,IAAI,CAACnF,OACxB,CAAC,CAAC,CAEF;AACA,KAAM,CAAA0F,SAAS,CAAG,CAAElG,IAAI,CAAE,WAAW,CAAEC,OAAO,CAAE0F,IAAI,CAACd,QAAQ,EAAIc,IAAI,CAACF,IAAI,EAAIE,IAAI,CAACP,OAAQ,CAAC,CAC5FrF,WAAW,CAACoG,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAED,SAAS,CAAC,CAAC,CAEzC;AACA;AACA,GAAIP,IAAI,CAACrF,QAAQ,EAAIqF,IAAI,CAACnF,OAAO,CAAE,CACjC,GAAI,KAAA4F,cAAA,CAAAC,iBAAA,CACFxE,OAAO,CAACC,GAAG,CAAC,kDAAkD,CAAC,CAC/DD,OAAO,CAACC,GAAG,CAAC,eAAe,CAAE6D,IAAI,CAACrF,QAAQ,CAAC,CAC3CuB,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAE,EAAAsE,cAAA,CAAAT,IAAI,CAACnF,OAAO,UAAA4F,cAAA,iBAAZA,cAAA,CAAcrE,MAAM,GAAI,CAAC,CAAC,CAE/D;AACA,KAAM,CAAA0C,UAAU,CAAGC,OAAO,CAACC,GAAG,CAACC,qBAAqB,EAAI,uBAAuB,CAC/E,KAAM,CAAA0B,YAAY,CAAG,GAAG7B,UAAU,GAAGkB,IAAI,CAACrF,QAAQ,EAAE,CAEpD;AACA,KAAM,CAAAiG,gBAAgB,CAAGZ,IAAI,CAACnF,OAAO,CAACgG,GAAG,CAACC,MAAM,GAAK,CACnDC,MAAM,CAAED,MAAM,CAACC,MAAM,CACrBC,QAAQ,CAAEF,MAAM,CAACE,QACnB,CAAC,CAAC,CAAC,CAEH9E,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAEwE,YAAY,CAAEC,gBAAgB,CAACxE,MAAM,CAAE,SAAS,CAAC,CAC9FxB,WAAW,CAAC+F,YAAY,CAAC,CACzB7F,UAAU,CAAC8F,gBAAgB,CAAC,CAC5B5F,YAAY,CAAC,IAAI,CAAC,CAElB;AACA,KAAM,CAAAiG,cAAc,CAAG,EAAAP,iBAAA,CAAAE,gBAAgB,CAACA,gBAAgB,CAACxE,MAAM,CAAG,CAAC,CAAC,UAAAsE,iBAAA,iBAA7CA,iBAAA,CAA+CK,MAAM,GAAI,IAAI,CACpFxC,UAAU,CAAC,IAAM,CACfvD,YAAY,CAAC,KAAK,CAAC,CACrB,CAAC,CAAEiG,cAAc,CAAG,IAAI,CAAC,CAE3B,CAAE,MAAOC,UAAU,CAAE,CACnBhF,OAAO,CAACkC,KAAK,CAAC,mCAAmC,CAAE8C,UAAU,CAAC,CAChE,CACF,CAAC,IAAM,KAAAC,cAAA,CACLjF,OAAO,CAACC,GAAG,CAAC,uDAAuD,CAAC,CACpED,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAE,CACpCZ,YAAY,CAAEA,YAAY,CAC1B6F,gBAAgB,CAAE,MAAO,CAAA7F,YAAY,CACrC2E,WAAW,CAAE,CAAC,CAACF,IAAI,CAACrF,QAAQ,CAC5BwF,aAAa,CAAE,CAAC,CAACH,IAAI,CAACnF,OAAO,CAC7BwG,YAAY,CAAE,MAAO,CAAArB,IAAI,CAACrF,QAAQ,CAClC0F,cAAc,CAAE,MAAO,CAAAL,IAAI,CAACnF,OAAO,CACnCF,QAAQ,CAAEqF,IAAI,CAACrF,QAAQ,EAAI,MAAM,CACjCyF,gBAAgB,CAAE,EAAAe,cAAA,CAAAnB,IAAI,CAACnF,OAAO,UAAAsG,cAAA,iBAAZA,cAAA,CAAc/E,MAAM,GAAI,CAAC,CAC3CkF,YAAY,CAAEC,MAAM,CAACC,IAAI,CAACxB,IAAI,CAAC,CAC/ByB,gBAAgB,CAAE,CAChBC,kBAAkB,CAAE,CAAC,CAACnG,YAAY,CAClCoG,cAAc,CAAE,CAAC,CAAC3B,IAAI,CAACrF,QAAQ,CAC/BiH,gBAAgB,CAAE,CAAC,CAAC5B,IAAI,CAACnF,OAAO,CAChCgH,gBAAgB,CAAE,CAAC,EAAEtG,YAAY,EAAIyE,IAAI,CAACrF,QAAQ,EAAIqF,IAAI,CAACnF,OAAO,CACpE,CACF,CAAC,CAAC,CACJ,CAEF,CAAE,MAAOuD,KAAK,CAAE,CACdlC,OAAO,CAACkC,KAAK,CAAC,8CAA8C,CAAEA,KAAK,CAAC,CACpElC,OAAO,CAACkC,KAAK,CAAC,eAAe,CAAEA,KAAK,CAAC0D,IAAI,CAAC,CAC1C5F,OAAO,CAACkC,KAAK,CAAC,kBAAkB,CAAEA,KAAK,CAACqB,OAAO,CAAC,CAChDvD,OAAO,CAACkC,KAAK,CAAC,gBAAgB,CAAEA,KAAK,CAAC2D,KAAK,CAAC,CAC5C,KAAM,CAAAC,YAAY,CAAG,CAAE3H,IAAI,CAAE,WAAW,CAAEC,OAAO,CAAE,kCAAkC8D,KAAK,CAACqB,OAAO,qBAAsB,CAAC,CACzHrF,WAAW,CAACoG,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAEwB,YAAY,CAAC,CAAC,CAC9C,CAAC,OAAS,CACRtH,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAAE,CAACD,SAAS,CAAEc,YAAY,CAAC,CAAC,CAE7B;AACA7B,SAAS,CAAC,IAAM,CACdwC,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC,CACpD,GAAI,yBAAyB,EAAI,CAAAJ,MAAM,EAAI,mBAAmB,EAAI,CAAAA,MAAM,CAAE,CACxE,KAAM,CAAAkG,iBAAiB,CAAGlG,MAAM,CAACkG,iBAAiB,EAAIlG,MAAM,CAACmG,uBAAuB,CACpF,KAAM,CAAAC,mBAAmB,CAAG,GAAI,CAAAF,iBAAiB,CAAC,CAAC,CAEnDE,mBAAmB,CAACC,UAAU,CAAG,KAAK,CACtCD,mBAAmB,CAACE,cAAc,CAAG,KAAK,CAC1CF,mBAAmB,CAACG,IAAI,CAAG,OAAO,CAElCH,mBAAmB,CAACI,OAAO,CAAG,IAAM,CAClCrG,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC,CAC5Cf,cAAc,CAAC,IAAI,CAAC,CACtB,CAAC,CAED+G,mBAAmB,CAACK,QAAQ,CAAIC,KAAK,EAAK,CACxC,KAAM,CAAAC,UAAU,CAAGD,KAAK,CAACE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACD,UAAU,CACjDxG,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAEuG,UAAU,CAAC,CAEzD;AACA,GAAIA,UAAU,CAAC9D,IAAI,CAAC,CAAC,CAAE,CACrB;AACA,KAAM,CAAAgE,WAAW,CAAG,CAAEvI,IAAI,CAAE,MAAM,CAAEC,OAAO,CAAEoI,UAAW,CAAC,CACzDtI,WAAW,CAACoG,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAEoC,WAAW,CAAC,CAAC,CAE3C;AACAlE,eAAe,CAACgE,UAAU,CAAC,CAC7B,CAEAtH,cAAc,CAAC,KAAK,CAAC,CACrBF,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAEDiH,mBAAmB,CAAC7D,OAAO,CAAImE,KAAK,EAAK,CACvCvG,OAAO,CAACkC,KAAK,CAAC,6BAA6B,CAAEqE,KAAK,CAACrE,KAAK,CAAC,CACzDhD,cAAc,CAAC,KAAK,CAAC,CACrBF,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAEDiH,mBAAmB,CAACU,KAAK,CAAG,IAAM,CAChC3G,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC,CAC1Cf,cAAc,CAAC,KAAK,CAAC,CACrBF,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAEDI,cAAc,CAAC6G,mBAAmB,CAAC,CACnCjG,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAC,CACjD,CAAC,IAAM,CACLD,OAAO,CAACmC,IAAI,CAAC,qDAAqD,CAAC,CACrE,CACF,CAAC,CAAE,CAACK,eAAe,CAAC,CAAC,CAErB,KAAM,CAAAoE,WAAW,CAAGnJ,WAAW,CAAC,SAAY,CAC1CuC,OAAO,CAACC,GAAG,CAAC,0CAA0C,CAAE5B,YAAY,CAAC,CACrE,GAAI,CAACA,YAAY,CAACqE,IAAI,CAAC,CAAC,EAAInE,SAAS,CAAE,CACrCyB,OAAO,CAACC,GAAG,CAAC,2CAA2C,CAAC,CACxD,OACF,CAEA;AACA,GAAI,CAACZ,YAAY,CAAE,CACjBW,OAAO,CAACC,GAAG,CAAC,sDAAsD,CAAC,CACnEX,eAAe,CAAC,IAAI,CAAC,CAAE;AACvB2B,WAAW,CAAC,CAAC,CAACgB,KAAK,CAACC,KAAK,EAAI,CAC3BlC,OAAO,CAACmC,IAAI,CAAC,0CAA0C,CAAED,KAAK,CAAC,CACjE,CAAC,CAAC,CACJ,CAEA;AACA,KAAM,CAAAwE,WAAW,CAAG,CAAEvI,IAAI,CAAE,MAAM,CAAEC,OAAO,CAAEC,YAAa,CAAC,CAC3DH,WAAW,CAACoG,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAEoC,WAAW,CAAC,CAAC,CAE3C;AACA,KAAM,CAAAG,aAAa,CAAGxI,YAAY,CAClCC,eAAe,CAAC,EAAE,CAAC,CAEnB;AACA0B,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC,CACrD,KAAM,CAAAuC,eAAe,CAACqE,aAAa,CAAC,CACtC,CAAC,CAAE,CAACxI,YAAY,CAAEE,SAAS,CAAEc,YAAY,CAAE4B,WAAW,CAAEuB,eAAe,CAAC,CAAC,CAEzE,KAAM,CAAAsE,cAAc,CAAGrJ,WAAW,CAAEsJ,CAAC,EAAK,CACxC/G,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAE8G,CAAC,CAACC,GAAG,CAAC,CACrC,GAAID,CAAC,CAACC,GAAG,GAAK,OAAO,EAAI,CAACD,CAAC,CAACE,QAAQ,CAAE,CACpCF,CAAC,CAACG,cAAc,CAAC,CAAC,CAClBN,WAAW,CAAC,CAAC,CACf,CACF,CAAC,CAAE,CAACA,WAAW,CAAC,CAAC,CAEjB,KAAM,CAAAO,gBAAgB,CAAG1J,WAAW,CAAC,SAAY,CAC/CuC,OAAO,CAACC,GAAG,CAAC,oDAAoD,CAAE,CAAC,CAACd,WAAW,CAAC,CAChF,GAAI,CAACA,WAAW,CAAE,CAChBiI,KAAK,CAAC,0FAA0F,CAAC,CACjG,OACF,CAEA;AACA,GAAI,CAAC/H,YAAY,CAAE,CACjBW,OAAO,CAACC,GAAG,CAAC,iEAAiE,CAAC,CAC9EX,eAAe,CAAC,IAAI,CAAC,CAAE;AACvB2B,WAAW,CAAC,CAAC,CAACgB,KAAK,CAACC,KAAK,EAAI,CAC3BlC,OAAO,CAACmC,IAAI,CAAC,0CAA0C,CAAED,KAAK,CAAC,CACjE,CAAC,CAAC,CACJ,CAEA,GAAIjD,WAAW,CAAE,CACf;AACAe,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC,CAC7Cd,WAAW,CAACkI,IAAI,CAAC,CAAC,CAClBnI,cAAc,CAAC,KAAK,CAAC,CACrBF,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,IAAM,CACL;AACA,GAAI,CACFgB,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC,CAC7Cd,WAAW,CAACmI,KAAK,CAAC,CAAC,CACnBtI,cAAc,CAAC,IAAI,CAAC,CACtB,CAAE,MAAOkD,KAAK,CAAE,CACdlC,OAAO,CAACkC,KAAK,CAAC,sCAAsC,CAAEA,KAAK,CAAC,CAC5DkF,KAAK,CAAC,sEAAsE,CAAC,CAC7EpI,cAAc,CAAC,KAAK,CAAC,CACvB,CACF,CACF,CAAC,CAAE,CAACG,WAAW,CAAEE,YAAY,CAAE4B,WAAW,CAAEhC,WAAW,CAAC,CAAC,CAEzD,mBACElB,KAAA,QAAKwJ,SAAS,CAAC,KAAK,CAAAC,QAAA,eAGlBzJ,KAAA,QAAK0J,KAAK,CAAE,CACVC,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,OAAO,CACfC,UAAU,CAAE,SAAS,CACrBC,aAAa,CAAE,QAAQ,CACvBC,cAAc,CAAE,YAAY,CAC5BC,UAAU,CAAE,QAAQ,CACpBC,OAAO,CAAE,MAAM,CACfC,SAAS,CAAE,YACb,CAAE,CAAAT,QAAA,eAGA3J,IAAA,QAAK4J,KAAK,CAAE,CACVC,KAAK,CAAE,MAAM,CACbQ,QAAQ,CAAE,UAAU,CACpBC,IAAI,CAAE,CAAC,CAAE;AACTH,OAAO,CAAE,MAAM,CACfD,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAClB,CAAE,CAAAN,QAAA,cACA3J,IAAA,QAAK4J,KAAK,CAAE,CACVO,OAAO,CAAE,MAAM,CACfH,aAAa,CAAE,KAAK,CACpBE,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxBI,QAAQ,CAAE,UAAU,CACpBR,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MACV,CAAE,CAAAH,QAAA,cACAzJ,KAAA,QAAK0J,KAAK,CAAE,CACVQ,SAAS,CAAE,YAAY,CACvBD,OAAO,CAAE,MAAM,CACfH,aAAa,CAAElI,WAAW,CAAG,IAAI,CAAG,QAAQ,CAAG,KAAK,CAAE;AACtDyI,GAAG,CAAE,EAAE,CACPL,UAAU,CAAEpI,WAAW,CAAG,IAAI,CAAG,SAAS,CAAG,QAAQ,CAAE;AACvDmI,cAAc,CAAE,QAAQ,CACxBO,WAAW,CAAE9I,iBAAiB,CAC9B+I,YAAY,CAAE/I,iBAAiB,CAC/BgJ,UAAU,CAAE,EAAE,CACdC,aAAa,CAAE,EAAE,CACjBN,QAAQ,CAAE,UAAU,CACpBR,KAAK,CAAE,MAAM,CACbjI,QAAQ,CAAEA,QAAQ,CAClBgJ,MAAM,CAAE,QACV,CAAE,CAAAjB,QAAA,eAGA3J,IAAA,QAAK4J,KAAK,CAAE,CACVU,IAAI,CAAExI,WAAW,CAAG,IAAI,CAAG,UAAU,CAAG,WAAW,CACnDgI,MAAM,CAAEhI,WAAW,CAAG,IAAI,CAAG,GAAG,CAAG,GAAG,CACtCqI,OAAO,CAAE,MAAM,CACfH,aAAa,CAAE,QAAQ,CACvBE,UAAU,CAAE,YAAY,CACxBD,cAAc,CAAE,QAAQ,CACxBY,OAAO,CAAE,CAAC,CACVR,QAAQ,CAAE,UAAU,CACpBS,SAAS,CAAEhJ,WAAW,CAAG,IAAI,CAAG,OAAO,CAAG,OAAO,CACjDiJ,QAAQ,CAAEjJ,WAAW,CAAG,IAAI,CAAG,MAAM,CAAG,OAAO,CAC/C+H,KAAK,CAAE/H,WAAW,CAAG,IAAI,CAAG,MAAM,CAAG,MACvC,CAAE,CAAA6H,QAAA,cACA3J,IAAA,QAAK4J,KAAK,CAAE,CACVoB,SAAS,CAAE,SAAS,CACpBlB,MAAM,CAAEhI,WAAW,CAAG,IAAI,CAAG,GAAG,CAAG,GAAG,CACtCmJ,YAAY,CAAE,EAAE,CAChBC,QAAQ,CAAE,QAAQ,CAClBb,QAAQ,CAAE,UAAU,CACpBR,KAAK,CAAE,MAAM,CACbsB,QAAQ,CAAE,CAAC,CACXC,UAAU,CAAE,CAAC,CACbC,SAAS,CAAE,CAAC,CACZP,SAAS,CAAEhJ,WAAW,CAAG,IAAI,CAAG,OAAO,CAAG,OAAO,CACjDiJ,QAAQ,CAAEjJ,WAAW,CAAG,IAAI,CAAG,MAAM,CAAG,OAAO,CAC/CF,QAAQ,CAAEE,WAAW,CAAG,IAAI,CAAG,MAAM,CAAG,OAAO,CAC/CwJ,cAAc,CAAE,OAAO,CACvBC,kBAAkB,CAAE,QAAQ,CAC5BC,gBAAgB,CAAE,WACpB,CAAE,CAAA7B,QAAA,cACA3J,IAAA,CAACF,MAAM,EACoC;AACzC2L,QAAQ,CAAE,IAAK,CACfC,SAAS,CAAE1K,SAAU,CACrB2K,UAAU,CAAEjL,SAAU,CACtBI,OAAO,CAAEA,OAAQ,CACjBF,QAAQ,CAAEA,QAAS,CACnBY,YAAY,CAAEA,YAAa,CAC3BwB,KAAK,CAAEF,oBAAoB,CAAC,CAAE,EAPzB,UAAUA,oBAAoB,CAAC,CAAC,EAQtC,CAAC,CACC,CAAC,CACH,CAAC,cAGN9C,IAAA,QAAK4J,KAAK,CAAE,CACVU,IAAI,CAAExI,WAAW,CAAG,IAAI,CAAG,UAAU,CAAG,OAAO,CAC/CgI,MAAM,CAAEhI,WAAW,CAAG,IAAI,CAAG,GAAG,CAAG,GAAG,CACtCiI,UAAU,CAAE,SAAS,CACrBkB,YAAY,CAAE,EAAE,CAChBH,SAAS,CAAEhJ,WAAW,CAAG,IAAI,CAAG,OAAO,CAAG,OAAO,CACjDiJ,QAAQ,CAAEjJ,WAAW,CAAG,IAAI,CAAG,MAAM,CAAG,KAAK,CAC7C+H,KAAK,CAAE/H,WAAW,CAAG,IAAI,CAAG,MAAM,CAAG,MAAM,CAC3C+I,OAAO,CAAE/I,WAAW,CAAG,IAAI,CAAG,KAAK,CAAG,UAAU,CAChDqI,OAAO,CAAE,MAAM,CACfH,aAAa,CAAE,QAAQ,CACvBkB,QAAQ,CAAE,QACZ,CAAE,CAAAvB,QAAA,cAGAzJ,KAAA,QAAK0J,KAAK,CAAE,CACVU,IAAI,CAAE,CAAC,CACPsB,SAAS,CAAE,MAAM,CACjBzB,OAAO,CAAE,MAAM,CACfH,aAAa,CAAE,QAAQ,CACvBO,GAAG,CAAE,MAAM,CACXsB,SAAS,CAAE,MAAM,CACjBC,YAAY,CAAE,MAAM,CACpBtB,WAAW,CAAE1I,WAAW,CAAG,IAAI,CAAG,MAAM,CAAG,KAAK,CAChD2I,YAAY,CAAE3I,WAAW,CAAG,IAAI,CAAG,MAAM,CAAG,KAC9C,CAAE,CAAA6H,QAAA,EACCvJ,QAAQ,CAAC0G,GAAG,CAAC,CAACpB,OAAO,CAAEqG,KAAK,gBAC3B/L,IAAA,QAAiB4J,KAAK,CAAE,CACtBO,OAAO,CAAE,MAAM,CACfF,cAAc,CAAEvE,OAAO,CAACpF,IAAI,GAAK,MAAM,CAAG,UAAU,CAAG,YAAY,CACnE4J,UAAU,CAAE,YACd,CAAE,CAAAP,QAAA,cACA3J,IAAA,QAAK4J,KAAK,CAAE,CACVhI,QAAQ,CAAE,KAAK,CACfiJ,OAAO,CAAE,WAAW,CACpBI,YAAY,CAAEvF,OAAO,CAACpF,IAAI,GAAK,MAAM,CAAG,oBAAoB,CAAG,oBAAoB,CACnF0L,eAAe,CAAEtG,OAAO,CAACpF,IAAI,GAAK,MAAM,CAAG,SAAS,CAAG,OAAO,CAC9D2L,KAAK,CAAEvG,OAAO,CAACpF,IAAI,GAAK,MAAM,CAAG,OAAO,CAAG,MAAM,CACjD4L,QAAQ,CAAE,MAAM,CAChBC,UAAU,CAAE,KAAK,CACjBC,SAAS,CAAE,2BAA2B,CACtCC,SAAS,CAAE3G,OAAO,CAACpF,IAAI,GAAK,MAAM,CAAG,OAAO,CAAG,MACjD,CAAE,CAAAqJ,QAAA,CACCjE,OAAO,CAACnF,OAAO,CACb,CAAC,EAjBEwL,KAkBL,CACN,CAAC,CAEDrL,SAAS,eACRV,IAAA,QAAK4J,KAAK,CAAE,CACVO,OAAO,CAAE,MAAM,CACfF,cAAc,CAAE,YAAY,CAC5BC,UAAU,CAAE,YACd,CAAE,CAAAP,QAAA,cACAzJ,KAAA,QAAK0J,KAAK,CAAE,CACViB,OAAO,CAAE,WAAW,CACpBI,YAAY,CAAE,oBAAoB,CAClCe,eAAe,CAAE,OAAO,CACxBC,KAAK,CAAE,MAAM,CACbC,QAAQ,CAAE,MAAM,CAChB/B,OAAO,CAAE,MAAM,CACfD,UAAU,CAAE,QAAQ,CACpBK,GAAG,CAAE,KAAK,CACV6B,SAAS,CAAE,2BACb,CAAE,CAAAzC,QAAA,eACA3J,IAAA,QAAK4J,KAAK,CAAE,CACVC,KAAK,CAAE,KAAK,CACZC,MAAM,CAAE,KAAK,CACbmB,YAAY,CAAE,KAAK,CACnBe,eAAe,CAAE,MAAM,CACvBM,SAAS,CAAE,qBACb,CAAE,CAAE,CAAC,cACLtM,IAAA,QAAK4J,KAAK,CAAE,CACVC,KAAK,CAAE,KAAK,CACZC,MAAM,CAAE,KAAK,CACbmB,YAAY,CAAE,KAAK,CACnBe,eAAe,CAAE,MAAM,CACvBM,SAAS,CAAE,0BACb,CAAE,CAAE,CAAC,cACLtM,IAAA,QAAK4J,KAAK,CAAE,CACVC,KAAK,CAAE,KAAK,CACZC,MAAM,CAAE,KAAK,CACbmB,YAAY,CAAE,KAAK,CACnBe,eAAe,CAAE,MAAM,CACvBM,SAAS,CAAE,0BACb,CAAE,CAAE,CAAC,cACLtM,IAAA,SAAM4J,KAAK,CAAE,CAAE2C,UAAU,CAAE,KAAM,CAAE,CAAA5C,QAAA,CAAC,aAAW,CAAM,CAAC,EACnD,CAAC,CACH,CACN,cAGD3J,IAAA,QAAKwM,GAAG,CAAEtK,cAAe,CAAC0H,KAAK,CAAE,CAAEE,MAAM,CAAE,KAAM,CAAE,CAAE,CAAC,EACnD,CAAC,CACH,CAAC,EACH,CAAC,CACH,CAAC,CACH,CAAC,cAGN9J,IAAA,QAAK4J,KAAK,CAAE,CACVC,KAAK,CAAE,MAAM,CACbQ,QAAQ,CAAE,UAAU,CACpBe,UAAU,CAAE,CAAC,CACbS,SAAS,CAAE,MAAO;AACpB,CAAE,CAAAlC,QAAA,cACA3J,IAAA,QAAK4J,KAAK,CAAE,CACVO,OAAO,CAAE,MAAM,CACfH,aAAa,CAAE,KAAK,CACpBE,UAAU,CAAE,QAAQ,CACpBG,QAAQ,CAAE,UAAU,CACpBR,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MACV,CAAE,CAAAH,QAAA,cACAzJ,KAAA,QAAK0J,KAAK,CAAE,CACVQ,SAAS,CAAE,YAAY,CACvBD,OAAO,CAAE,MAAM,CACfH,aAAa,CAAE,KAAK,CACpBO,GAAG,CAAE,EAAE,CACPL,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,YAAY,CAC5BO,WAAW,CAAE9I,iBAAiB,CAC9B+I,YAAY,CAAE/I,iBAAiB,CAC/BgJ,UAAU,CAAE,CAAC,CACbC,aAAa,CAAE,EAAE,CACjBN,QAAQ,CAAE,UAAU,CACpBR,KAAK,CAAE,MAAM,CACbjI,QAAQ,CAAEA,QAAQ,CAClBgJ,MAAM,CAAE,QACV,CAAE,CAAAjB,QAAA,eAGA3J,IAAA,QAAK4J,KAAK,CAAE,CACVS,QAAQ,CAAE,UAAU,CACpBe,UAAU,CAAE,CAAC,CACbvB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EACV,CAAE,CAAAH,QAAA,cACA3J,IAAA,WAAQ4J,KAAK,CAAE,CACbS,QAAQ,CAAE,UAAU,CACpBoC,IAAI,CAAE,CAAC,CACPC,GAAG,CAAE,CAAC,CACN7C,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACVC,UAAU,CAAE,aAAa,CACzBkB,YAAY,CAAE,EAAE,CAChB0B,MAAM,CAAE,MAAM,CACdC,MAAM,CAAE,SAAS,CACjBzC,OAAO,CAAE,MAAM,CACfD,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAClB,CAAE,CAAAN,QAAA,cACAzJ,KAAA,QACE2J,KAAK,CAAC,IAAI,CACVC,MAAM,CAAC,IAAI,CACX+C,OAAO,CAAC,WAAW,CACnBC,IAAI,CAAC,MAAM,CACXC,KAAK,CAAC,4BAA4B,CAAApD,QAAA,eAElC3J,IAAA,SACEgN,CAAC,CAAC,0tBAA0tB,CAC5tBF,IAAI,CAAC,2BAA2B,CACjC,CAAC,cACF9M,IAAA,SAAA2J,QAAA,cACEzJ,KAAA,mBACE+M,EAAE,CAAC,qBAAqB,CACxBC,EAAE,CAAC,SAAS,CACZC,EAAE,CAAC,SAAS,CACZC,EAAE,CAAC,SAAS,CACZC,EAAE,CAAC,SAAS,CACZC,aAAa,CAAC,gBAAgB,CAAA3D,QAAA,eAE9B3J,IAAA,SAAMuN,SAAS,CAAC,OAAO,CAAC,CAAC,cACzBvN,IAAA,SAAMwN,MAAM,CAAC,GAAG,CAACD,SAAS,CAAC,SAAS,CAAC,CAAC,EACxB,CAAC,CACb,CAAC,EACJ,CAAC,CACA,CAAC,CACN,CAAC,cAGNrN,KAAA,QAAK0J,KAAK,CAAE,CACVuB,QAAQ,CAAE,CAAC,CACXC,UAAU,CAAE,CAAC,CACbC,SAAS,CAAE,CAAC,CACZvB,MAAM,CAAE,EAAE,CACVC,UAAU,CAAE,SAAS,CACrBkB,YAAY,CAAE,EAAE,CAChBH,SAAS,CAAE,KAAK,CAChBC,QAAQ,CAAE,KAAK,CACfV,QAAQ,CAAE,UAAU,CACpBF,OAAO,CAAE,MAAM,CACfD,UAAU,CAAE,QAAQ,CACpBkC,SAAS,CAAE,2BACb,CAAE,CAAAzC,QAAA,eACA3J,IAAA,UACEyN,IAAI,CAAC,MAAM,CACXC,KAAK,CAAElN,YAAa,CACpBmN,QAAQ,CAAGzE,CAAC,EAAK,CACf/G,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAE8G,CAAC,CAAC0E,MAAM,CAACF,KAAK,CAAC,CAChDjN,eAAe,CAACyI,CAAC,CAAC0E,MAAM,CAACF,KAAK,CAAC,CACjC,CAAE,CACFG,UAAU,CAAE5E,cAAe,CAC3B6E,OAAO,CAAEA,CAAA,GAAM3L,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAE,CAC/C2L,MAAM,CAAEA,CAAA,GAAM5L,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAE,CAC9C4L,OAAO,CAAEA,CAAA,GAAM7L,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAE,CAChD6L,WAAW,CACT7M,WAAW,CACP,cAAc,CACd,oBACL,CACD8M,QAAQ,CAAExN,SAAS,EAAIU,WAAY,CACnCwI,KAAK,CAAE,CACLC,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACde,OAAO,CAAE,mBAAmB,CAAE;AAC9B8B,MAAM,CAAE,MAAM,CACd1B,YAAY,CAAE,EAAE,CAChBiB,QAAQ,CAAE,MAAM,CAChBC,UAAU,CAAE,MAAM,CAClBgC,OAAO,CAAE,MAAM,CACfC,UAAU,CAAE,SAAS,CACrBpC,eAAe,CAAE,aAAa,CAC9BC,KAAK,CAAE,MACT,CAAE,CACH,CAAC,cAGFjM,IAAA,WACEgO,OAAO,CAAEA,CAAA,GAAM,CACb7L,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC,CACrC2G,WAAW,CAAC,CAAC,CACf,CAAE,CACFmF,QAAQ,CAAE,CAAC1N,YAAY,CAACqE,IAAI,CAAC,CAAC,EAAInE,SAAS,EAAIU,WAAY,CAC3DwI,KAAK,CAAE,CACLS,QAAQ,CAAE,UAAU,CACpBgE,KAAK,CAAE,MAAM,CACb3B,GAAG,CAAE,KAAK,CACV4B,SAAS,CAAE,kBAAkB,CAC7BzE,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACdmB,YAAY,CAAE,KAAK,CACnB0B,MAAM,CAAE,MAAM,CACd5C,UAAU,CAAG,CAACvJ,YAAY,CAACqE,IAAI,CAAC,CAAC,EAAInE,SAAS,EAAIU,WAAW,CAAI,MAAM,CAAG,SAAS,CACnFwL,MAAM,CAAG,CAACpM,YAAY,CAACqE,IAAI,CAAC,CAAC,EAAInE,SAAS,EAAIU,WAAW,CAAI,aAAa,CAAG,SAAS,CACtF+I,OAAO,CAAE,MAAM,CACfD,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxBsE,UAAU,CAAE,eAAe,CAC3BnC,SAAS,CAAE,2BACb,CAAE,CACFoC,YAAY,CAAGtF,CAAC,EAAK,CACnB,GAAI1I,YAAY,CAACqE,IAAI,CAAC,CAAC,EAAI,CAACnE,SAAS,EAAI,CAACU,WAAW,CAAE,CACrD8H,CAAC,CAAC0E,MAAM,CAAChE,KAAK,CAAC0E,SAAS,CAAG,6BAA6B,CAC1D,CACF,CAAE,CACFG,YAAY,CAAGvF,CAAC,EAAK,CACnB,GAAI1I,YAAY,CAACqE,IAAI,CAAC,CAAC,EAAI,CAACnE,SAAS,EAAI,CAACU,WAAW,CAAE,CACrD8H,CAAC,CAAC0E,MAAM,CAAChE,KAAK,CAAC0E,SAAS,CAAG,kBAAkB,CAC/C,CACF,CAAE,CAAA3E,QAAA,CAEDjJ,SAAS,cACRR,KAAA,QAAK2J,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAAC+C,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAAAnD,QAAA,eACzD3J,IAAA,WAAQ0O,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,CAAC,CAAC,IAAI,CAACC,MAAM,CAAC,OAAO,CAACC,WAAW,CAAC,GAAG,CAACC,OAAO,CAAC,KAAK,CAAE,CAAC,cAC9E/O,IAAA,SACEgN,CAAC,CAAC,iLAAiL,CACnL6B,MAAM,CAAC,OAAO,CACdC,WAAW,CAAC,GAAG,CACfE,aAAa,CAAC,OAAO,CAAArF,QAAA,cAErB3J,IAAA,qBACEiP,aAAa,CAAC,WAAW,CACzBC,aAAa,CAAC,KAAK,CACnBzB,IAAI,CAAC,QAAQ,CACb0B,IAAI,CAAC,SAAS,CACdC,EAAE,CAAC,WAAW,CACdC,GAAG,CAAC,IAAI,CACRC,WAAW,CAAC,YAAY,CACzB,CAAC,CACE,CAAC,EACJ,CAAC,cAENtP,IAAA,QAAK6J,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAAC+C,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAAAnD,QAAA,cACzD3J,IAAA,SACEgN,CAAC,CAAC,iCAAiC,CACnC6B,MAAM,CAAC,OAAO,CACdC,WAAW,CAAC,GAAG,CACfE,aAAa,CAAC,OAAO,CACrBO,cAAc,CAAC,OAAO,CACvB,CAAC,CACC,CACN,CACK,CAAC,EACN,CAAC,cAGNvP,IAAA,QAAK4J,KAAK,CAAE,CACVQ,SAAS,CAAE,YAAY,CACvBD,OAAO,CAAE,MAAM,CACfH,aAAa,CAAE,KAAK,CACpBO,GAAG,CAAE,EAAE,CACPL,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,UAAU,CAC1BY,OAAO,CAAE,CAAC,CACVR,QAAQ,CAAE,UAAU,CACpBe,UAAU,CAAE,CACd,CAAE,CAAAzB,QAAA,cAEA3J,IAAA,QAAK4J,KAAK,CAAE,CACVS,QAAQ,CAAE,UAAU,CACpBe,UAAU,CAAE,CAAC,CACbvB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EACV,CAAE,CAAAH,QAAA,cACAzJ,KAAA,WACE8N,OAAO,CAAEA,CAAA,GAAM,CACb7L,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC,CAC3CkH,gBAAgB,CAAC,CAAC,CACpB,CAAE,CACFM,KAAK,CAAE,CACLS,QAAQ,CAAE,UAAU,CACpBN,UAAU,CAAE3I,WAAW,CAAG,SAAS,CAAG,SAAS,CAC/CqL,IAAI,CAAE,CAAC,CACPC,GAAG,CAAE,CAAC,CACNzB,YAAY,CAAE,EAAE,CAChBpB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACV6C,MAAM,CAAE,MAAM,CACdC,MAAM,CAAE,SAAS,CACjBzC,OAAO,CAAE,MAAM,CACfD,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxBmC,SAAS,CAAEhL,WAAW,CAAG,mCAAmC,CAAG,2BAA2B,CAC1FmN,UAAU,CAAE,eAAe,CAC3BD,SAAS,CAAElN,WAAW,CAAG,YAAY,CAAG,UAAU,CAClD8J,QAAQ,CAAE,QAAS;AACrB,CAAE,CAAAvB,QAAA,EAGD,CAACzI,WAAW,EAAIE,WAAW,gBAC1BpB,IAAA,QACE4J,KAAK,CAAE,CACLS,QAAQ,CAAE,UAAU,CACpBqC,GAAG,CAAE,KAAK,CACVD,IAAI,CAAE,KAAK,CACX5C,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACdC,UAAU,CAAE3I,WAAW,CAAG,0BAA0B,CAAG,wBAAwB,CAC/E6J,YAAY,CAAE,KAAK,CACnBqD,SAAS,CAAE,uBAAuB,CAClChC,SAAS,CAAE,kCAAkC,CAC7CkD,MAAM,CAAE,CACV,CAAE,CACH,CACF,cAEDtP,KAAA,QACE2J,KAAK,CAAC,IAAI,CACVC,MAAM,CAAC,IAAI,CACX+C,OAAO,CAAC,WAAW,CACnBC,IAAI,CAAC,MAAM,CACXC,KAAK,CAAC,4BAA4B,CAClCnD,KAAK,CAAE,CAAES,QAAQ,CAAE,UAAU,CAAEmF,MAAM,CAAE,CAAE,CAAE,CAAA7F,QAAA,eAE3C3J,IAAA,SACEyP,QAAQ,CAAC,SAAS,CAClBC,QAAQ,CAAC,SAAS,CAClB1C,CAAC,CAAC,kbAAkb,CACpbF,IAAI,CAAE1L,WAAW,CAAG,SAAS,CAAG,SAAU,CAC3C,CAAC,cACFpB,IAAA,SACEyP,QAAQ,CAAC,SAAS,CAClBC,QAAQ,CAAC,SAAS,CAClB1C,CAAC,CAAC,mZAAmZ,CACrZF,IAAI,CAAE1L,WAAW,CAAG,SAAS,CAAG,SAAU,CAC3C,CAAC,EACC,CAAC,EACA,CAAC,CACN,CAAC,CACH,CAAC,EACH,CAAC,CACH,CAAC,CACH,CAAC,EAEH,CAAC,cAGNpB,IAAA,UAAA2J,QAAA,CAAQ;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,CAAQ,CAAC,EACP,CAAC,CAEV,CAEA,cAAe,CAAAxJ,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}